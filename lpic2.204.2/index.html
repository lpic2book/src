
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Sue B.V., The Netherlands">
      
      
      
        <link rel="prev" href="../lpic2.204.1/">
      
      
        <link rel="next" href="../lpic2.204.3/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Adjusting Storage Device Access (204.2) - The LPIC2 Exam Prep</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,300i,400,400i,700,700i%7CAnonymous+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Nunito";--md-code-font:"Anonymous Pro"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adjusting-storage-device-access-2042" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="The LPIC2 Exam Prep" class="md-header__button md-logo" aria-label="The LPIC2 Exam Prep" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The LPIC2 Exam Prep
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Adjusting Storage Device Access (204.2)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/lpic2book/src" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    LPIC2Book
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="The LPIC2 Exam Prep" class="md-nav__button md-logo" aria-label="The LPIC2 Exam Prep" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"/></svg>

    </a>
    The LPIC2 Exam Prep
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lpic2book/src" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    LPIC2Book
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The LPIC2 Exam Prep
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpicbook_about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About this book
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.200.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    200 Capacity Planning (200)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.200.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Measure and Troubleshoot Resource Usage (200.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.200.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Predict Future Resource Needs (200.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux Kernel (201)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel Components (201.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compiling a Linux kernel (201.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel runtime management and troubleshooting (201.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Startup (202)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Customizing system startup (202.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System recovery (202.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alternate Bootloaders (202.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filesystem and Devices (203)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operating The Linux Filesystem (203.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Maintaining a Linux Filesystem (203.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Creating And Configuring Filesystem Options (203.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Storage Device Administration (204)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring RAID (204.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Adjusting Storage Device Access (204.2)
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Adjusting Storage Device Access (204.2)
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adjusting-storage-device-access-2042" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adjusting Storage Device Access (204.2)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adjusting Storage Device Access (204.2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-knowledge-areas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Knowledge Areas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terms-and-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terms and Utilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-disks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring disks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring disks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-iscsi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring iSCSI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iscsi-initiator" class="md-nav__link">
    <span class="md-ellipsis">
      
        iSCSI Initiator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iscsi-target" class="md-nav__link">
    <span class="md-ellipsis">
      
        iSCSI Target
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-target-on-the-target-host" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding a new target (on the target host)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wwid" class="md-nav__link">
    <span class="md-ellipsis">
      
        WWID
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lun" class="md-nav__link">
    <span class="md-ellipsis">
      
        LUN
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-device-name-persistence-aka-lun-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring device name persistence (aka LUN persistence)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-device-name-persistence-without-multipath" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing device name persistence without multipath
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-device-name-persistence-with-multipath" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing device name persistence with multipath
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Physical installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-tune2fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using tune2fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-hdparm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using hdparm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-sdparm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using sdparm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-kernel-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring kernel options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-proc-filesystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using the /proc filesystem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-sysctl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using sysctl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logical Volume Manager (204.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring PCMCIA Devices (204.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking Configuration (205)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Networking Configuration (205.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Network Configuration and Troubleshooting (205.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting network issues (205.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Maintenance (206)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Make and install programs from source (206.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup Operations (206.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notifying users on system-related issues (206.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Domain Name Server (207)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic DNS server configuration (207.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create and maintain DNS zones (207.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Securing a DNS Server (207.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HTTP Services (208)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Apache Configuration (208.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Apache configuration for HTTPS (208.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Implementing Squid as a caching proxy (208.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Implementing Nginx as a web server and a reverse proxy (208.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.209.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Sharing (209)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.209.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SAMBA Server Configuration (209.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.209.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring an NFS Server (209.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Client Management (210)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DHCP Configuration (210.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PAM authentication (210.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LDAP client usage (210.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring an OpenLDAP server (210.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Mail services (211)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using e-mail servers (211.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing E-Mail Delivery (211.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing Mailbox Access (211.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Security (212)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring a router (212.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing FTP servers (212.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Secure shell (SSH) (212.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security tasks (212.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenVPN (212.5)
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adjusting-storage-device-access-2042" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adjusting Storage Device Access (204.2)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adjusting Storage Device Access (204.2)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-knowledge-areas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Knowledge Areas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terms-and-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terms and Utilities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-disks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring disks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring disks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-iscsi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring iSCSI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iscsi-initiator" class="md-nav__link">
    <span class="md-ellipsis">
      
        iSCSI Initiator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iscsi-target" class="md-nav__link">
    <span class="md-ellipsis">
      
        iSCSI Target
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-target-on-the-target-host" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding a new target (on the target host)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wwid" class="md-nav__link">
    <span class="md-ellipsis">
      
        WWID
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lun" class="md-nav__link">
    <span class="md-ellipsis">
      
        LUN
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-device-name-persistence-aka-lun-persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring device name persistence (aka LUN persistence)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-device-name-persistence-without-multipath" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing device name persistence without multipath
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-device-name-persistence-with-multipath" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementing device name persistence with multipath
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Physical installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-tune2fs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using tune2fs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-hdparm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using hdparm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-sdparm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using sdparm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-kernel-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring kernel options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-proc-filesystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using the /proc filesystem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-sysctl" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using sysctl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Adjusting Storage Device Access (204.2)</h1>

<h2 id="adjusting-storage-device-access-2042">Adjusting Storage Device Access (204.2)<a class="headerlink" href="#adjusting-storage-device-access-2042" title="Permanent link">&para;</a></h2>
<p>Candidates should be able to configure kernel options to support various
drives. This objective includes software tools to view and modify hard
disk settings including iSCSI devices.</p>
<h3 id="key-knowledge-areas">Key Knowledge Areas<a class="headerlink" href="#key-knowledge-areas" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Tools and utilities to configure DMA for IDE devices including ATAPI
    and SATA</p>
</li>
<li>
<p>Tools and utilities to manipulate or analyse system resources (e.g.
    interrupts)</p>
</li>
<li>
<p>Awareness of <code>sdparm</code> command and its uses</p>
</li>
<li>
<p>Tools and utilities for iSCSI</p>
</li>
<li>
<p>SSD and NVMe configuration and awareness of SAN</p>
</li>
</ul>
<h3 id="terms-and-utilities">Terms and Utilities<a class="headerlink" href="#terms-and-utilities" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>hdparm</code></p>
</li>
<li>
<p><code>sdparm</code></p>
</li>
<li>
<p><code>tune2fs</code></p>
</li>
<li>
<p><code>sysctl</code></p>
</li>
<li>
<p><code>iscsiadm, scsi_id, iscsid</code> and <code>iscsid.conf</code></p>
</li>
<li>
<p><code>/dev/hd*</code> and <code>/dev/sd*</code></p>
</li>
<li>
<p>WWID, WWN, LUN numbers</p>
</li>
</ul>
<h3 id="configuring-disks">Configuring disks<a class="headerlink" href="#configuring-disks" title="Permanent link">&para;</a></h3>
<h4 id="configuring-iscsi">Configuring iSCSI<a class="headerlink" href="#configuring-iscsi" title="Permanent link">&para;</a></h4>
<p>iSCSI is an abbreviation of Internet Small Computer System Interface.
iSCSI is simply a networked implementation of the well-known
standardized SCSI protocol. SCSI defines a model, cabling, electrical
signals and commands to use to access various devices. iSCSI uses just
the model and the commands. SCSI (and hence: iSCSI) can be used to
access all kinds of devices and though mostly used for disks and
tape-units has been used to access USB storage, printers and flatbed
scanners too, just to name a few.</p>
<p>The iSCSI setup is similar to the SCSI setup as it consists of a client
and a server. In between is an IP based network, which can be a LAN, WAN
or the Internet. The client issues low level SCSI commands as usual
(e.g. <code>read</code>, <code>write</code>, <code>seek</code> or <code>erase</code>). The commands can be encrypted
by the client and are then encapsulated and sent over the network. The
server receives and possibly decrypts the commands and executes the
commands. Unlike traditional Fibre Channel, which requires
special-purpose cabling, iSCSI can be run over long distances using
existing network infrastructure.</p>
<p>Clients are refered to as "initiators". The commands are referred to as
"CDBs" (Command Descriptor Blocks) and the server storage devices are
known as "targets".</p>
<p>Definitions: iSCSI target, iSCSI initiator The exported storage entity
is the <em>target</em> and the importing entity is the <em>initiator</em>.</p>
<h4 id="iscsi-initiator">iSCSI Initiator<a class="headerlink" href="#iscsi-initiator" title="Permanent link">&para;</a></h4>
<p>On Linux hosts that act as a client (initiator) to a iSCSI server
(target) you will need to install the client software. You will also
need to edit the configuration file so you can discover the desired
target(s). On Red Hat Linux and its derivatives the configuration file
is <code>/etc/iscsi/iscsid.conf</code>. Edit the file so it points to the proper
server (target) and contains a set of valid credentials - see example
file at the bottom of this segment.</p>
<p>After configuration, ensure that the iSCSI service runs using the
following command:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /etc/init.d/iscsi status
</code></pre></div></td></tr></table></div>

<p>If needed start the iSCSI service using the following command:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /etc/init.d/iscsi start
</code></pre></div></td></tr></table></div>

<p>iscsiadm Use the <code>iscsiadm</code> command to discover the targets. Where our
example shows questionmarks, substitute the IP address of the target:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    iscsiadm -m discovery -t sendtargets -p ???.???.???.???
</code></pre></div></td></tr></table></div>

<p>After successfully discovering targets you can log in into the volumes
that were discovered. This can be done with the <code>iscsiadm</code> tool, which
can also be used to log out of a volume. A fast way to add newly
discovered volumes is to restart the iscsi service:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /etc/init.d/iscsi restart
</code></pre></div></td></tr></table></div>

<p><em>Hint</em>:</p>
<p>When adding an iscsi mount point to the <code>fstab</code> file use the <code>_netdev</code>
option:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /dev/sdb1 /mnt/iscsi ext3(4) _netdev 0 0
</code></pre></div></td></tr></table></div>

<p>The <code>_netdev</code> option ensures that the network is up before trying to
mount the device.</p>
<p>Example <code>/etc/iscsi/iscsid.config</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">###############</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">iSNS</span><span class="w"> </span><span class="nx">settings</span>
<span class="w">    </span><span class="err">###############</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">Address</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">iSNS</span><span class="w"> </span><span class="nx">server</span>
<span class="w">    </span><span class="nx">isns</span><span class="p">.</span><span class="nx">address</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">***</span><span class="p">.</span><span class="o">***</span><span class="p">.</span><span class="o">***</span><span class="p">.</span><span class="o">***</span>
<span class="w">    </span><span class="nx">isns</span><span class="p">.</span><span class="nx">port</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3260</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="o">*************</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">CHAP</span><span class="w"> </span><span class="nx">Settings</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="o">*************</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">To</span><span class="w"> </span><span class="nx">enable</span><span class="w"> </span><span class="nx">CHAP</span><span class="w"> </span><span class="nx">authentication</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authmethod</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">CHAP</span><span class="p">.</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">.</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authmethod</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">CHAP</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">To</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">CHAP</span><span class="w"> </span><span class="nx">username</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">initiator</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">authentication</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">target</span><span class="p">(</span><span class="nx">s</span><span class="p">),</span><span class="w"> </span><span class="nx">uncomment</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">lines</span><span class="p">:</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">username</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">********</span>
<span class="w">    </span><span class="nx">node</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">********</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">To</span><span class="w"> </span><span class="nx">enable</span><span class="w"> </span><span class="nx">CHAP</span><span class="w"> </span><span class="nx">authentication</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">discovery</span><span class="w"> </span><span class="nx">session</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">target</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">discovery</span><span class="p">.</span><span class="nx">sendtargets</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authmethod</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">CHAP</span><span class="p">.</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">None</span><span class="p">.</span>
<span class="w">    </span><span class="nx">discovery</span><span class="p">.</span><span class="nx">sendtargets</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">authmethod</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">CHAP</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">To</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">discovery</span><span class="w"> </span><span class="nx">session</span><span class="w"> </span><span class="nx">CHAP</span><span class="w"> </span><span class="nx">username</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">initiator</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">authentication</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">target</span><span class="p">(</span><span class="nx">s</span><span class="p">),</span><span class="w"> </span><span class="nx">uncomment</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">lines</span><span class="p">:</span>
<span class="w">    </span><span class="nx">discovery</span><span class="p">.</span><span class="nx">sendtargets</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">username</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">********</span>
<span class="w">    </span><span class="nx">discovery</span><span class="p">.</span><span class="nx">sendtargets</span><span class="p">.</span><span class="nx">auth</span><span class="p">.</span><span class="nx">password</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">********</span>
</code></pre></div></td></tr></table></div>

<h4 id="iscsi-target">iSCSI Target<a class="headerlink" href="#iscsi-target" title="Permanent link">&para;</a></h4>
<p>There are a number of ways to set up a target. The SCSI Target Framework
(STGT/TGT) was the standard before linux 2.6.38. The current standard is
the LIO target.</p>
<p>Another well-known implementation was the iSCSI Enterprise Target (IET)
and its successor the SCSI Target Subsystem (SCST). IET was a candidate
for kernel inclusion too, but LIO was the final choice. LIO (an
abbreviation of linux-iscsi.org) now is the standard open-source SCSI
Target for shared data storage in Linux. It supports all prevalent
storage fabrics, including Fibre Channel (QLogic), FCoE, iEEE 1394,
iSCSI, iSER (Mellanox InfiniBand), SRP (Mellanox InfiniBand), USB,
vHost, etc.</p>
<h4 id="adding-a-new-target-on-the-target-host">Adding a new target (on the target host)<a class="headerlink" href="#adding-a-new-target-on-the-target-host" title="Permanent link">&para;</a></h4>
<p>To add a new iSCSI target edit the <code>/etc/tgt/targets.conf</code> configuration
file. This file contains many examples of different configuration
options that have been commented out. A basic target may be defined as:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nt">&lt;target</span><span class="w"> </span><span class="err">iqn.2008-09.com.example:server.target1</span><span class="nt">&gt;</span>
<span class="w">        </span>backing-store<span class="w"> </span>/srv/images/iscsi-share.img
<span class="w">        </span>direct-store<span class="w"> </span>/dev/sdd
<span class="w">    </span><span class="nt">&lt;/target&gt;</span>
</code></pre></div></td></tr></table></div>

<p>This example defines a single target with two LUNs. LUNs are described
with either the backing-store or direct-store directives where
backing-store refers to either a file or a block device, and
direct-store refers to local SCSI devices. Device parameters, such as
serial numbers and vendor names, will be passed through to the new iSCSI
LUN.</p>
<p>The target service is aptly named <code>tgtd</code>. To start it run:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    # service tgtd start
</code></pre></div></td></tr></table></div>

<p>To stop the <code>tgtd</code> service, run:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    # service tgtd stop
</code></pre></div></td></tr></table></div>

<p>If there are open connections, use:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    # service tgtd force-stop
    Warning Using this command will terminate all target arrays.
</code></pre></div></td></tr></table></div>

<h4 id="wwid">WWID<a class="headerlink" href="#wwid" title="Permanent link">&para;</a></h4>
<p>Any connected SCSI device is assigned a unique device name. The device
name begins with <code>/dev/sd</code>, for example <code>/dev/sdd</code>, <code>/dev/sda</code>.
Additionally, each SCSI device has a unique World Wide Identifier
(WWID). The identifier can be obtained from the device itself by issuing
the <code>inquiry</code> command. On Linux systems you can find the WWIDs in the
<code>/dev/disk/by-id/</code> directory, in which you will find symbolic links
whose names contain the WWID and which point to the assigned device
name. There are two types of WWIDs, known as 'page 0x83' and 'page
0x80' and any SCSI device has one of these.</p>
<p>For example, a device with a page 0x83 identifier would have:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="n">scsi</span><span class="o">-</span><span class="mi">3600508</span><span class="n">b400105e210000900000490000</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">sda</span>
</code></pre></div></td></tr></table></div>

<p>Or, a device with a page 0x80 identifier would have:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="n">scsi</span><span class="o">-</span><span class="n">SSEAGATE_ST373453LW_3HW1RHM6</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">sda</span>
</code></pre></div></td></tr></table></div>

<p>Red Hat Enterprise Linux automatically maintains the proper mapping from
the WWID-based device name to a current <code>/dev/sd</code> name on that system.
Applications can use the <code>/dev/disk/by-id/</code> name to reference the data
on the disk, even if the path to the device changes, and even when
accessing the device from different systems. This also allows detection
and access to plugable devices, say a photocamera. If it is plugged in,
the system will sent a <code>inquiry</code> command and will create the proper
symbolic link, hence allowing you to access the camera under the same
name.</p>
<p>It is possible and feasible to have more than one path to a device, for
example to offer a fail-over or fall-back option and/or to increase
performance. Such "paths" might be implemented as additional network
paths (preferably using their own network card) or over fibre
(preferably using their own HBAs) etc. If there are multiple paths from
a system to a device, a special kernel-module and associated daemons and
other software will use the WWID to detect the paths. A single
"pseudo-device" in <code>/dev/mapper/wwid</code> will be created by them, such as
<code>/dev/mapper/3600508b400105df70000e00000ac0000</code>, which will give access
to the device, regardless which path(s) to it there are in use, as long
as at least one of them can be used ('is active').</p>
<p>The command <code>multipath -l</code> shows the mapping to the non-persistent
identifiers: Host:Channel:Target:LUN, <code>/dev/sd</code> name, and the
major:minor number:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="mi">3600508</span><span class="n">b400105df70000e00000ac0000</span><span class="w"> </span><span class="n">dm</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="n">vendor</span><span class="p">,</span><span class="n">product</span><span class="w"> </span>
<span class="w">    </span><span class="o">[</span><span class="n">size=20G</span><span class="o">][</span><span class="n">features=1 queue_if_no_path</span><span class="o">][</span><span class="n">hwhandler=0</span><span class="o">][</span><span class="n">rw</span><span class="o">]</span><span class="w"> </span>
<span class="w">    </span><span class="err">\</span><span class="n">_</span><span class="w"> </span><span class="nf">round</span><span class="o">-</span><span class="n">robin</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">[</span><span class="n">prio=0</span><span class="o">][</span><span class="n">active</span><span class="o">]</span><span class="w"> </span>
<span class="w">    </span><span class="err">\</span><span class="n">_</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="mi">0</span><span class="err">:</span><span class="mi">1</span><span class="err">:</span><span class="mi">1</span><span class="w"> </span><span class="n">sdc</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="mi">32</span><span class="w">  </span><span class="o">[</span><span class="n">active</span><span class="o">][</span><span class="n">undef</span><span class="o">]</span><span class="w"> </span>
<span class="w">    </span><span class="err">\</span><span class="n">_</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="mi">0</span><span class="err">:</span><span class="mi">1</span><span class="err">:</span><span class="mi">1</span><span class="w"> </span><span class="n">sdg</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="mi">96</span><span class="w">  </span><span class="o">[</span><span class="n">active</span><span class="o">][</span><span class="n">undef</span><span class="o">]</span>
<span class="w">    </span><span class="err">\</span><span class="n">_</span><span class="w"> </span><span class="nf">round</span><span class="o">-</span><span class="n">robin</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">[</span><span class="n">prio=0</span><span class="o">][</span><span class="n">enabled</span><span class="o">]</span><span class="w"> </span>
<span class="w">    </span><span class="err">\</span><span class="n">_</span><span class="w"> </span><span class="mi">5</span><span class="err">:</span><span class="mi">0</span><span class="err">:</span><span class="mi">0</span><span class="err">:</span><span class="mi">1</span><span class="w"> </span><span class="n">sdb</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="mi">16</span><span class="w">  </span><span class="o">[</span><span class="n">active</span><span class="o">][</span><span class="n">undef</span><span class="o">]</span><span class="w"> </span>
<span class="w">    </span><span class="err">\</span><span class="n">_</span><span class="w"> </span><span class="mi">6</span><span class="err">:</span><span class="mi">0</span><span class="err">:</span><span class="mi">0</span><span class="err">:</span><span class="mi">1</span><span class="w"> </span><span class="n">sdf</span><span class="w"> </span><span class="mi">8</span><span class="err">:</span><span class="mi">80</span><span class="w">  </span><span class="o">[</span><span class="n">active</span><span class="o">][</span><span class="n">undef</span><span class="o">]</span>
</code></pre></div></td></tr></table></div>

<p>Device-mapper-multipath automatically maintains the proper mapping of
each WWID-based device name to its corresponding <code>/dev/sd</code> name on the
system. These names are persistent a cross path changes, and they are
consistent when accessing the device from different systems. When the
user_friendly_names feature (of device-mapper-multipath) is used, the
WWID is mapped to a name of the form <code>/dev/mapper/mpathn</code>. By default,
this mapping is maintained in the file <code>/etc/multipath/bindings</code>. These
<code>mpath</code> names are persistent as long as the file is maintained.</p>
<p><strong>Note</strong>
Important If you use user_friendly_names, then additional steps are
required to obtain consistent names in a cluster. Refer to the
Consistent Multipath Device Names in a Cluster section in the Using DM
Multipath Configuration and Administration book.</p>
<h4 id="lun">LUN<a class="headerlink" href="#lun" title="Permanent link">&para;</a></h4>
<p>Another way to address a SCSI device is by using its LUN, the Logical
unit number. The LUN is a three bit number (0..7) which indicates a
device within a target. Any target should at least have a device with
LUN 0, which can be used like any device, but is also capable of
providing information about the other LUNs in the device (if any). If
there is just one device in a target that device has LUN 0 as any target
should have a LUN 0.</p>
<p>Say you bought a SCSI device that contained three disks (all connected
over the same SCSI cable). To find out how many disks there are in your
target (or tape units etc.) you would sent an inquiry to LUN 0. The
device that has LUN 0 is designed to be able to tell you the
configuration and might report that it knows of other devices. To
address these the client uses the LUNs as specified by LUN 0.</p>
<p>Because SCSI disks were often refered to by their LUN, the habit stuck
and nowadays the term is also used to refer to a logical disk in a SAN.
But there can be many more LUNs in a SAN than the humble 7 that are used
in older configurations. Also, such a SAN-LUN may well consist of series
of disks, which might possibly be configured as a RAID, possibly
subdivided in volumes etc. - to the client, it is just a disk with a
LUN.</p>
<h4 id="configuring-device-name-persistence-aka-lun-persistence">Configuring device name persistence (aka LUN persistence)<a class="headerlink" href="#configuring-device-name-persistence-aka-lun-persistence" title="Permanent link">&para;</a></h4>
<p>Linux device names may change upon boot. This can lead to confusion and
damage to data. Therefore, there are a number of techniques that allow
persistent names for devices. This section covers how to implement
device name persistence in guests and on the host machine with and
without multipath. Persistence simply means that you will have the same
name for the device, regardles its access paths. So, your camera or disk
is always recognised as such and will be issued the same device name,
regardless where you plug it in.</p>
<h4 id="implementing-device-name-persistence-without-multipath">Implementing device name persistence without multipath<a class="headerlink" href="#implementing-device-name-persistence-without-multipath" title="Permanent link">&para;</a></h4>
<p>If your system is not using multipath, you can use <code>udev</code> to implement
LUN persistence. <code>udev</code> is a device manager that listens to an interface
with the kernel. If a new device is plugged in or a device is being
detached, <code>udev</code> will receive a signal from the kernel and, using a set
of rules, will perform actions, for example assign an additional device
name to the device.</p>
<p>Before implementing LUN persistence in your system you will first need
to acquire the proper WWIDs from the devices you want to control. This
can be done by using the <code>scsi_id</code> program. After you required the WWIDs
of your devices, you will need to write a rule so <code>udev</code> can assign a
persistent name to it.</p>
<p>scsi_id A minor hurdle has to be taken first. The <code>scsi_id</code> program
will not list any device by default and will only list devices it has
been told to see ('whitelisted' devices). To whitelist a device you
will need to add its WWID to the <code>scsi_id</code> configuration file, which is
<code>/etc/scsi_id.conf</code>. That's safe, but a nuisance if you want to
discover WWIDs of new devices. Hence you can specify the <code>-g</code> option to
allow detection of any disk that has not been listed yet. If you feel
that this should be the default behaviour, you may consider editing
<code>/etc/scsi_id.conf</code>. If there is a line that says:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    options=-b
</code></pre></div></td></tr></table></div>

<p>delete it or comment it out. Then add a line that says:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    options=-g
</code></pre></div></td></tr></table></div>

<p>If this has been configured, next time a program uses the <code>scsi_id</code>
command, it will add the <code>-g</code> option (and any other options you might
have specified in the configuration file) and hence allow extracting the
WWIDs from new devices. The <code>-g</code> should be used either by default from
the configuration file or be set manually in any <code>udev</code> rule that uses
the <code>scsi_id</code> command, or else your newly plugged in device won't be
recognised.</p>
<p>You then will need to find out what device file your new device was
allocated by the kernel. This is routinely done by using the command
<code>dmesg</code> after you plugged in the new device. Typically, you will see
lines similar to these:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nx">usb</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">high</span><span class="w"> </span><span class="nx">speed</span><span class="w"> </span><span class="nx">USB</span><span class="w"> </span><span class="nx">device</span><span class="w"> </span><span class="nx">using</span><span class="w"> </span><span class="nx">ehci_hcd</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="mi">25</span>
<span class="w">    </span><span class="nx">usb</span><span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="nx">configuration</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w"> </span><span class="nx">chosen</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kd">choice</span>
<span class="w">    </span><span class="nx">scsi7</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">SCSI</span><span class="w"> </span><span class="nx">emulation</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">USB</span><span class="w"> </span><span class="nx">Mass</span><span class="w"> </span><span class="nx">Storage</span><span class="w"> </span><span class="nx">devices</span>
<span class="w">    </span><span class="nx">usb</span><span class="o">-</span><span class="nx">storage</span><span class="p">:</span><span class="w"> </span><span class="nx">device</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="mi">25</span>
<span class="w">    </span><span class="nx">usb</span><span class="o">-</span><span class="nx">storage</span><span class="p">:</span><span class="w"> </span><span class="nx">waiting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">device</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">settle</span><span class="w"> </span><span class="nx">before</span><span class="w"> </span><span class="nx">scanning</span>
<span class="w">      </span><span class="nx">Vendor</span><span class="p">:</span><span class="w"> </span><span class="nx">USB</span><span class="w">       </span><span class="nx">Model</span><span class="p">:</span><span class="w"> </span><span class="nx">Flash</span><span class="w"> </span><span class="nx">Disk</span><span class="w">        </span><span class="nx">Rev</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">8.07</span>
<span class="w">      </span><span class="nx">Type</span><span class="p">:</span><span class="w">   </span><span class="nx">Direct</span><span class="o">-</span><span class="nx">Access</span><span class="w">                      </span><span class="nx">ANSI</span><span class="w"> </span><span class="nx">SCSI</span><span class="w"> </span><span class="nx">revision</span><span class="p">:</span><span class="w"> </span><span class="mi">04</span>
<span class="w">    </span><span class="nx">SCSI</span><span class="w"> </span><span class="nx">device</span><span class="w"> </span><span class="nx">sdc</span><span class="p">:</span><span class="w"> </span><span class="mi">7886848</span><span class="w"> </span><span class="mi">512</span><span class="o">-</span><span class="nx">byte</span><span class="w"> </span><span class="nx">hdwr</span><span class="w"> </span><span class="nx">sectors</span><span class="w"> </span><span class="p">(</span><span class="mi">4038</span><span class="w"> </span><span class="nx">MB</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>

<p>As you see, we plugged in a 4Gb Flash Disk that was assigned the device
name 'sdc'. This device is now available as <code>/sys/block/sdc</code> in the
<code>/sys</code> pseudo-filesystem, and also as a devicefile <code>/dev/sdc</code>.</p>
<p>To determine the device WWID, use the <code>scsi_id</code> command:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    # scsi_id -g -u -s /block/sdc
    3200049454505080f
</code></pre></div></td></tr></table></div>

<p>As you see, we used the <code>-g</code> forcibly. The <code>-s</code> option specifies that
you want to use the device name relative to the root of the <code>sysfs</code>
filesystem (<code>/sys</code>). Newer versions of scsi_id (e.g. those in RHEL6) do
not allow use of <code>sysfs</code> names anymore, so should use the device name
then:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    /sbin/scsi_id -g -u -d /dev/sdc
    3200049454505080f
</code></pre></div></td></tr></table></div>

<p>The long string of characters in the output is the WWID. The WWID does
not change when you add a new device to your system. Acquire the WWID
for each device in order to create rules for the devices. To create new
device rules, edit the <code>20-names.rules</code> file in the <code>/etc/udev/rules.d</code>
directory. The device naming rules follow this format:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nx">KERNEL</span><span class="o">=</span><span class="err">&quot;</span><span class="nx">sd</span><span class="cp">&lt;?</span><span class="o">&gt;</span><span class="s2">&quot;,  BUS=&quot;</span><span class="nx">scsi</span><span class="s2">&quot;,  PROGRAM=&quot;</span><span class="o">&lt;</span><span class="nx">scsi_id</span> <span class="o">-</span><span class="nx">options</span><span class="o">..&gt;</span><span class="s2">&quot;, RESULT=&quot;</span><span class="o">&lt;</span><span class="nx">WWID</span><span class="o">&gt;</span><span class="s2">&quot;, NAME=&quot;</span><span class="o">&lt;</span><span class="nx">devicename</span><span class="o">&gt;</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>

<p>So, when you plug in a new device the kernel will signal <code>udev</code> it found
a new SCSCI device. the PROGRAM will be executed and the RESULT should
match. If so, the NAME will be used for the device file.</p>
<p>An example would be:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    KERNEL=&quot;sd*&quot;,  BUS=&quot;scsi&quot;,  PROGRAM=&quot;/sbin/scsi_id -g -u -d /dev/$parent&quot;, RESULT=&quot;3200049454505080f&quot;, NAME=&quot;bookone&quot;
</code></pre></div></td></tr></table></div>

<p>Or on RHEL6 systems:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    KERNEL=&quot;sd*&quot;,  BUS=&quot;scsi&quot;,  PROGRAM=&quot;/sbin/scsi_id -g -u -s /block/$parent&quot;, RESULT=&quot;3200049454505080f&quot;, NAME=&quot;bookone&quot;
</code></pre></div></td></tr></table></div>

<p>When the kernel allocates a new device which name matches the KERNEL
pattern, the PROGRAM is executed and when the RESULT is found the NAME
is created. Note the <code>-g</code> option that we have included so we can
actually see the device, though it is not whitelisted.</p>
<p>The <code>udevd</code> daemon is typically started by the execution of a local
startup script, normally done by the <code>init</code> process and initiated by a
line in the <code>/etc/inittab</code> file. On older systems you would ensure that
this line was in <code>/etc/rc.local</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /sbin/start_udev
</code></pre></div></td></tr></table></div>

<p>On some systems, e.g. RHEL6 the line should be in <code>/etc/rc.sysinit</code>.</p>
<h4 id="implementing-device-name-persistence-with-multipath">Implementing device name persistence with multipath<a class="headerlink" href="#implementing-device-name-persistence-with-multipath" title="Permanent link">&para;</a></h4>
<p>You can implement device name persistence by using the <code>multipath</code>
drivers and software. Of course, normally you would only use this if you
have more than one path to your device. But you can actually define a
<code>multipath</code> with only has one active path, and it will work just like
any other disk. Just define an alias and the name will be persistent
across boots.</p>
<p>The <code>multipath</code> software consists of a daemon, that guards the paths to
the various devices. It executes the external command <code>multipath</code> on
failure. The <code>multipath</code> command in turn will signal the daemon after it
has reconfigured paths.</p>
<p>To implement LUN persistence in a multipath environment, you can define
an alias name for the <code>multipath</code> device. Edit the device aliases in the
configuration file of the <code>multipath</code> daemon, <code>/etc/multipath.conf</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>    multipaths {
        multipath  {  
            wwid       3600a0b80001327510000015427b625e
            alias      backupdisk
        }
    }
</code></pre></div></td></tr></table></div>

<p>This defines a device that has a persistent device file
<code>/dev/mpath/backupdisk</code>. That will grant access to the device - whatever
its name - that has WWID 600a0b80001327510000015427b625e. The alias
names are persistent across reboots.</p>
<h3 id="physical-installation">Physical installation<a class="headerlink" href="#physical-installation" title="Permanent link">&para;</a></h3>
<p>To install a new disk in your
system, you will need to physically install the hard drive and configure
it in your computer's BIOS. Linux will detect the new drive
automatically in most cases. You could type <code>dmesg | more</code> to find out
the name and device file of the drive. As an example: the second IDE
drive in your system will be named <code>/dev/hdb</code>. We will assume that the
new drive is <code>/dev/hdb</code>.</p>
<p>On older kernels IDE devicenames match the pattern <code>/dev/hd[a-d]</code>, where
a is used for the primary master IDE device, b is the primary slave, c
the secondary master and d is the secondary slave IDE device. For
PATA/SATA drives the Linux SCSI driver is used as the PATA/SATA
architecture is similar to that of SCSCI. Newer devices hence have
device files that match the pattern <code>/dev/sd*</code>.</p>
<p>After installation of your disk and it being recognised by the
kernel you can choose to (re)partition your new disk. As <code>root</code> in a
shell type:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    fdisk /dev/hdb
</code></pre></div></td></tr></table></div>

<p>This will take you to a prompt</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="nv">Command</span><span class="w"> </span><span class="ss">(</span><span class="nv">m</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">help</span><span class="ss">)</span>:
</code></pre></div></td></tr></table></div>

<p>At the prompt, type <code>p</code> to display the existing partitions. If you have
partitions that you need to delete, type <code>d</code>, then at the prompt, type
the number of the partition that you wish to delete. Next, type <code>n</code> to
create the new partition. Type <code>1</code> (assuming that this will be the first
partition on the new drive), and hit <code>enter</code>. Then you will be prompted
for the cylinder that you want to start with on the drive. Next, you
will be asked for the ending cylinder for the partition. Repeat these
steps until all partitions are created.</p>
<p>To put a clean filesystem on the first partition of your newly
partitioned drive, type:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    mkfs /dev/hdb1
</code></pre></div></td></tr></table></div>

<p>Repeat this step for all partitions. You can use the <code>-t</code> parameter to
define the filesystem type to build, e.g. <code>ext2</code>, <code>ext3</code>, <code>xfs</code>, <code>minix</code>
etc. (<a href="#creating-filesystems">???</a>).</p>
<p>You will now need to decide the mount point for each new
partition on your drive. We will assume <code>/new</code>. Type:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    mkdir /new
</code></pre></div></td></tr></table></div>

<p>to create the mount point for your drive. Now you will need to edit
<code>/etc/fstab</code>. You will want to make an entry at the end of the file
similar to this:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /dev/hdb1       /new     ext2          defaults       1   1
</code></pre></div></td></tr></table></div>

<p>Modern SSDs (Solid State Disks) might profit from some optimisation.
SSDs are very fast compared to standard harddisks with platters but
they have a bigger chance of suffering from bad blocks after many
rewrites to blocks. An SSD can use TRIM to discard those blocks
efficiently. <code>noatime</code> or <code>relatime</code> can also be used to reduce the
amount of writes to disk. This will tell the filesystem not to keep
track of last accessed times, but only last modified times. In
<code>/etc/fstab</code> it would look like:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    /dev/hdb1        /new     ext4    discard,noatime       1      1
</code></pre></div></td></tr></table></div>

<p>NVM Express (NVMe) is a specification for accessing SSDs attached
through the PCI Express bus. The Linux NVMe driver is included in kernel
version 3.3 and higher. NVMe devices can be found under <code>/dev/nvme*</code>.
NVMe devices are a family of SSD's thatshould not be issued discards.
Discards are usualy disabled on setups that use ext4 and LVM, but other
filesystems might need discards to be disabled explicitly.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>     /dev/nvme0n1p1  /new     ext4 defaults 0 0
</code></pre></div></td></tr></table></div>

<p>Moving your <code>/tmp</code> partition to memory (tmpfs) is another way to reduce
disk writes. This is advisable if your system has enough memory. Add the
following entry to <code>/etc/fstab</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    none             /tmp/                   tmpfs   size=10%                 0       0
</code></pre></div></td></tr></table></div>

<p>After you have created a similar entry for each partition, write the
file.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    mount -a
</code></pre></div></td></tr></table></div>

<p>will mount the partitions in the directory that you specified in
<code>/etc/fstab</code>.</p>
<h3 id="using-tune2fs">Using <code>tune2fs</code><a class="headerlink" href="#using-tune2fs" title="Permanent link">&para;</a></h3>
<p>When a kernel interacts with ext2 or ext3 filesystems the
<code>tune2fs</code> command can be used to configure the interaction. Noteworthy
options of this command are:</p>
<p>-e error_behaviour</p>
<ul>
<li>
<p>This option defines how the kernel should react in case of errors on
    the filesystem to which this command is applied. Possible behaviours
    are:</p>
<p>continue</p>
<p>:   Ignore the error on the filesystem. Report the read or write
    error to the application that tries to access that part of the
    filesystem.</p>
<p>remount-ro</p>
<p>:   Remount the filesystem as read-only. This secures data that is
    already on disc. Applications that try to write to this
    filesystem will result in error.</p>
<p>panic</p>
<p>:   This causes a kernel panic and the system will halt.</p>
</li>
</ul>
<p>-m reserved_block_percentage</p>
<ul>
<li>
<p>Full filesystems have very bad performance due to fragmentation. To
    prevent regular users from filling up the whole filesystem a
    percentage of the blocks will be reserved. This reserved part cannot
    be used by regular users. Only the root user can make use this part
    of the filesystem.</p>
<p>The default percentage of the reserved blocks is 5%. With disks
becoming ever larger, setting aside 5% would result in a large
number of reserved blocks. For large disks 1% reserved blocks should
be sufficient for most filesystems.</p>
</li>
</ul>
<p>-O [^]mount_option</p>
<ul>
<li>
<p>This sets the mount options of the filesystem. Command line options
    or options in <code>/etc/fstab</code> take precedence. The ^-sign clears the
    specified option.</p>
<p>This option is supported by kernel 2.4.20 and above.</p>
</li>
</ul>
<p>-s [0|1]</p>
<ul>
<li>
<p>Enable or disable the sparse superblock feature. Enabling this
    feature on large filesystems saves space, because less superblocks
    are used.</p>
<p>After enabling or disabling this feature the filesystem must be made
valid again by running the <code>e2fsck</code> command.</p>
</li>
</ul>
<h3 id="using-hdparm">Using <code>hdparm</code><a class="headerlink" href="#using-hdparm" title="Permanent link">&para;</a></h3>
<p>The <code>hdparm</code> command is used to set/get SATA/IDE device
parameters. It provides a command line interface to various kernel
interfaces supported by the Linux SATA/PATA/SAS "libata" subsystem and
the older IDE driver subsystem. Newer (from 2008) USB disk enclosures
now support "SAT" (SCSI-ATA Command Translation) so they might also work
with <code>hdparm</code>.</p>
<p>The syntax for this command is:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="n">hdparm</span><span class="w"> </span><span class="o">[</span><span class="n">options</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">device</span><span class="o">]</span>
</code></pre></div></td></tr></table></div>

<p>Frequently used options are:</p>
<p>-a</p>
<ul>
<li>Get or set the sector count for filesystem read-ahead.</li>
</ul>
<p>-d [0|1]</p>
<ul>
<li>Get or set the <code>using_dma</code> flag.</li>
</ul>
<p>-g</p>
<ul>
<li>Display drive geometry.</li>
</ul>
<p>-i</p>
<ul>
<li>Display identification information.</li>
</ul>
<p>-r [0|1]</p>
<ul>
<li>Get (1) or set (0) the read-only flag.</li>
</ul>
<p>-t</p>
<ul>
<li>Perform device read for benchmarking.</li>
</ul>
<p>-T</p>
<ul>
<li>Perform device cache read for benchmarking.</li>
</ul>
<p>-v</p>
<ul>
<li>Display all settings, except -i.</li>
</ul>
<p>See also <code>man hdparm</code> for more information.</p>
<h3 id="using-sdparm">Using <code>sdparm</code><a class="headerlink" href="#using-sdparm" title="Permanent link">&para;</a></h3>
<p>The <code>sdparm</code> command is used to access SCSI mode pages, read VPD
(Vital Product Data) pages and send simple SCSI commands.</p>
<p>The utility fetches and can change SCSI device mode pages. Inquiry data
including Vital Product Data pages can also be displayed. Commands
associated with starting and stopping the medium; loading and unloading
the medium; and other housekeeping functionality may also be issued by
this utility.</p>
<h3 id="configuring-kernel-options">Configuring kernel options<a class="headerlink" href="#configuring-kernel-options" title="Permanent link">&para;</a></h3>
<p>In <a href="#lpic2.201.1">???</a> and on, the process to configure and debug
Configuring Linux kernel options kernels is described. Additional kernel
options may be configured by patching the kernel source code. Normally
the kernel's tunable parameters are listed in the various header files
in the source code tree. There is no golden rule to apply here - you
need to read the kernel documentation or may even need to crawl through
the kernel-code to find the information you need. Additionally, a
running kernel can be configured by either using the <code>/proc</code> filesystem
or by using the <code>sysctl</code> command.</p>
<h3 id="using-the-proc-filesystem">Using the <code>/proc</code> filesystem<a class="headerlink" href="#using-the-proc-filesystem" title="Permanent link">&para;</a></h3>
<p>Current kernels also support dynamic setting of kernel parameters. The
/proc easiest method to set kernel parameters is by modifying the
<code>/proc</code> filesystem. You can use the <code>echo</code> command to set parameters, in
the format:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    # echo value &gt; /proc/kernel/parameter
</code></pre></div></td></tr></table></div>

<p>e.g. to activate IP-forwarding:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    # echo 1 &gt;/proc/sys/net/ipv4/ip_forward
</code></pre></div></td></tr></table></div>

<p>The changes take effect immediately but are lost during reboot.
/proc/sys/net/ipv4/ip_forward</p>
<p>The <code>/proc/</code> filesystem can also be queried. To see which interrupts a
system uses, for example you could issue /proc/interrupts</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    # cat /proc/interrupts
</code></pre></div></td></tr></table></div>

<p>which generates output that may look like this:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code>               CPU0       
      0:   16313284          XT-PIC  timer
      1:     334558          XT-PIC  keyboard
      2:          0          XT-PIC  cascade
      7:      26565          XT-PIC  3c589_cs
      8:          2          XT-PIC  rtc
      9:          0          XT-PIC  OPL3-SA (MPU401)
     10:          4          XT-PIC  MSS audio codec
     11:          0          XT-PIC  usb-uhci
     12:     714357          XT-PIC  PS/2 Mouse
     13:          1          XT-PIC  fpu
     14:     123824          XT-PIC  ide0
     15:          7          XT-PIC  ide1
    NMI:          0
</code></pre></div></td></tr></table></div>

<p>On multicore systems you will see multiple CPU-columns, e.g. CPU0..CPU3
for a four core system. The interrupts are delivered to core 0 by
default. This can create a performance bottleneck, especially on
networked storage systems. As CPU0 gets swamped by IRQ's the system
feels sluggish, even when the other cores have almost nothing to do.
Newer kernels try to load balance the interrupts. But you can override
the defaults and choose which core will handle which interrupt. The
procedure is listed in the next paragraph.</p>
<p>Each interrupt listed in the <code>/proc/interrupts</code> file has a subdirectory
in the <code>/proc/irq/</code> tree. So, interrupt 12 corresponds to the directory
<code>/proc/irq/12</code>. In that directory the file <code>smp_affinity</code> contains data
that describes what core handles the interrupt. The file contains a
bitmask that has one bit per core. By setting the proper bit the APIC
chip will deliver the interrupt to the corresponding core, e.g. 2
selects CPU1, 4 selects CPU2, 8-3, 16-4.. etc. To set for example CPU5
to receive all interrupts #13, do:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    # echo 32 &gt;/proc/irq/13/smp_affinity
</code></pre></div></td></tr></table></div>

<p>By carefully selecting which interrupts go to which processor you can
dramatically influence the performance of a busy system.</p>
<h3 id="using-sysctl">Using <code>sysctl</code><a class="headerlink" href="#using-sysctl" title="Permanent link">&para;</a></h3>
<p>Kernel tuning can be automated by putting the <code>sysctl</code> commands
in the startup scripts (e.g. <code>/etc/sysctl.d/99-sysctl.conf</code>. The
<code>sysctl</code> command is used to modify kernel parameters at runtime. The
parameters that can be modified by this command are listed in the
<code>/proc/sys</code> directory tree. Procfs is required for <code>sysctl</code> support
under Linux. <code>sysctl</code> can be used to read as well as write kernel
parameters.</p>
<p>Frequently used options of the <code>sysctl</code> command are:</p>
<p><code>-a</code>; <code>-A</code></p>
<ul>
<li>Display all values currently available.</li>
</ul>
<p><code>-e</code></p>
<ul>
<li>Use this option to ignore errors about unknown keys.</li>
</ul>
<p><code>-n</code></p>
<ul>
<li>Use this option to disable printing of the key name when printing
    values.</li>
</ul>
<p><code>-p</code></p>
<ul>
<li>Load sysctl settings from the file specified, or /etc/sysctl.conf if
    none given. Specifying <code>-</code> as filename means reading data from
    standard input.</li>
</ul>
<p><code>-w</code></p>
<ul>
<li>Use this option to change a sysctl setting.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 1997-2021 Sue B.V., The Netherlands - Open Sourced 2021
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["search.highlight", "tabs", "instant"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>