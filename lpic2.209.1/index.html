
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Sue B.V., The Netherlands">
      
      
      
        <link rel="prev" href="../lpic2.209.0/">
      
      
        <link rel="next" href="../lpic2.209.2/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>SAMBA Server Configuration (209.1) - The LPIC2 Exam Prep</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,300i,400,400i,700,700i%7CAnonymous+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Nunito";--md-code-font:"Anonymous Pro"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#samba-server-configuration-2091" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="The LPIC2 Exam Prep" class="md-header__button md-logo" aria-label="The LPIC2 Exam Prep" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The LPIC2 Exam Prep
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SAMBA Server Configuration (209.1)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/lpic2book/src" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    LPIC2Book
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="The LPIC2 Exam Prep" class="md-nav__button md-logo" aria-label="The LPIC2 Exam Prep" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2z"/></svg>

    </a>
    The LPIC2 Exam Prep
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lpic2book/src" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    LPIC2Book
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The LPIC2 Exam Prep
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpicbook_about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About this book
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.200.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    200 Capacity Planning (200)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.200.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Measure and Troubleshoot Resource Usage (200.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.200.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Predict Future Resource Needs (200.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux Kernel (201)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel Components (201.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compiling a Linux kernel (201.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.201.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel runtime management and troubleshooting (201.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Startup (202)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Customizing system startup (202.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System recovery (202.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.202.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alternate Bootloaders (202.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filesystem and Devices (203)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Operating The Linux Filesystem (203.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Maintaining a Linux Filesystem (203.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.203.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Creating And Configuring Filesystem Options (203.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Storage Device Administration (204)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring RAID (204.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adjusting Storage Device Access (204.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logical Volume Manager (204.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.204.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring PCMCIA Devices (204.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking Configuration (205)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Networking Configuration (205.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Network Configuration and Troubleshooting (205.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.205.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting network issues (205.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Maintenance (206)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Make and install programs from source (206.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup Operations (206.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.206.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notifying users on system-related issues (206.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Domain Name Server (207)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic DNS server configuration (207.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create and maintain DNS zones (207.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.207.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Securing a DNS Server (207.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HTTP Services (208)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Apache Configuration (208.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Apache configuration for HTTPS (208.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Implementing Squid as a caching proxy (208.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.208.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Implementing Nginx as a web server and a reverse proxy (208.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.209.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Sharing (209)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    SAMBA Server Configuration (209.1)
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    SAMBA Server Configuration (209.1)
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#samba-server-configuration-2091" class="md-nav__link">
    <span class="md-ellipsis">
      
        SAMBA Server Configuration (209.1)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SAMBA Server Configuration (209.1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-2091-configuring-a-samba-server-5-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objective 209.1; Configuring a Samba Server (5 points)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-knowledge-areas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Knowledge Areas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terms-and-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terms and Utilities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-samba" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is Samba?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What is Samba?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-the-samba-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing the Samba components
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba commands
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samba commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#samba-core-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba core commands
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samba core commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smbstatus" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbstatus
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testparm" class="md-nav__link">
    <span class="md-ellipsis">
      
        testparm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbpasswd" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbpasswd
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmblookup" class="md-nav__link">
    <span class="md-ellipsis">
      
        nmblookup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbclient" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbclient
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samba-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        samba-tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net" class="md-nav__link">
    <span class="md-ellipsis">
      
        net
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commands-not-part-of-the-samba-core" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commands not part of the Samba core
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Commands not part of the Samba core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smbmount" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbmount
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samba-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba logging
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#account-information-databases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Account information databases
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Account information databases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smbpasswd_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbpasswd
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdbsam" class="md-nav__link">
    <span class="md-ellipsis">
      
        tdbsam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldapsam" class="md-nav__link">
    <span class="md-ellipsis">
      
        ldapsam
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samba configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#samba-configuration-directory-etcsmb-or-etcsamba" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba configuration directory /etc/smb or /etc/samba.
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbconf" class="md-nav__link">
    <span class="md-ellipsis">
      
        smb.conf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="smb.conf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-sections" class="md-nav__link">
    <span class="md-ellipsis">
      
        special sections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global" class="md-nav__link">
    <span class="md-ellipsis">
      
        [global]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-sections" class="md-nav__link">
    <span class="md-ellipsis">
      
        service sections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        User-level security
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#share-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Share-level security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-global-section-to-support-the-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic [global] section to support the examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-public-share-available-to-everyone" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make "public" share available to everyone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-share1-share-available-to-alice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make "share1" share available to alice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-share2-share-available-to-authenticated-users" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make "share2" share available to authenticated users
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-the-home-directories-available-to-their-respective-owners" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make the home directories available to their respective owners
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbexample5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Map remote user "alice.jones" to Linux user "alice"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-shares-on-windows-available-to-users-on-sambaclient" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make shares on "windows" available to users on "sambaclient"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-allow-everyone-to-print-on-all-printers-on-sambaserver" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Allow everyone to print on all printers on "sambaserver"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-disallow-printing-on-printer_1-from-sambaclient" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Disallow printing on "Printer_1" from "sambaclient"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-list-available-services-on-sambaserver" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: List available services on "sambaserver"
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-a-nmbd-wins-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting up a nmbd WINS server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up a nmbd WINS server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-a-wins-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is a WINS Server?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-samba-as-a-wins-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using Samba as a WINS Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Samba as a WINS Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-logon-scripts-for-clients" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating logon scripts for clients
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#based-on-the-users-name" class="md-nav__link">
    <span class="md-ellipsis">
      
        Based on the user's name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#based-on-the-clients-name" class="md-nav__link">
    <span class="md-ellipsis">
      
        Based on the client's name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-kerberos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Kerberos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-samba" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Samba
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Samba">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-up-the-smbconf-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting up the smb.conf file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joining-the-domain" class="md-nav__link">
    <span class="md-ellipsis">
      
        Joining the domain
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-name-service-switch-nss" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring the Name Service Switch (NSS)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Starting the services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-the-winbind-connectivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing the winbind connectivity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.209.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring an NFS Server (209.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Client Management (210)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DHCP Configuration (210.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PAM authentication (210.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LDAP client usage (210.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.210.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring an OpenLDAP server (210.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Mail services (211)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using e-mail servers (211.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing E-Mail Delivery (211.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.211.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing Mailbox Access (211.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Security (212)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring a router (212.1)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Managing FTP servers (212.2)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Secure shell (SSH) (212.3)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security tasks (212.4)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lpic2.212.5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenVPN (212.5)
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#samba-server-configuration-2091" class="md-nav__link">
    <span class="md-ellipsis">
      
        SAMBA Server Configuration (209.1)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SAMBA Server Configuration (209.1)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective-2091-configuring-a-samba-server-5-points" class="md-nav__link">
    <span class="md-ellipsis">
      
        Objective 209.1; Configuring a Samba Server (5 points)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-knowledge-areas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Knowledge Areas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terms-and-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Terms and Utilities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-samba" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is Samba?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What is Samba?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-the-samba-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing the Samba components
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba commands
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samba commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#samba-core-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba core commands
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samba core commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smbstatus" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbstatus
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testparm" class="md-nav__link">
    <span class="md-ellipsis">
      
        testparm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbpasswd" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbpasswd
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmblookup" class="md-nav__link">
    <span class="md-ellipsis">
      
        nmblookup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbclient" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbclient
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samba-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        samba-tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net" class="md-nav__link">
    <span class="md-ellipsis">
      
        net
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commands-not-part-of-the-samba-core" class="md-nav__link">
    <span class="md-ellipsis">
      
        Commands not part of the Samba core
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Commands not part of the Samba core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smbmount" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbmount
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#samba-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba logging
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#account-information-databases" class="md-nav__link">
    <span class="md-ellipsis">
      
        Account information databases
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Account information databases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smbpasswd_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        smbpasswd
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdbsam" class="md-nav__link">
    <span class="md-ellipsis">
      
        tdbsam
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldapsam" class="md-nav__link">
    <span class="md-ellipsis">
      
        ldapsam
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samba-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samba configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#samba-configuration-directory-etcsmb-or-etcsamba" class="md-nav__link">
    <span class="md-ellipsis">
      
        Samba configuration directory /etc/smb or /etc/samba.
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbconf" class="md-nav__link">
    <span class="md-ellipsis">
      
        smb.conf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="smb.conf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#special-sections" class="md-nav__link">
    <span class="md-ellipsis">
      
        special sections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global" class="md-nav__link">
    <span class="md-ellipsis">
      
        [global]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-sections" class="md-nav__link">
    <span class="md-ellipsis">
      
        service sections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        User-level security
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#share-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Share-level security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-global-section-to-support-the-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic [global] section to support the examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-public-share-available-to-everyone" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make "public" share available to everyone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-share1-share-available-to-alice" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make "share1" share available to alice
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-share2-share-available-to-authenticated-users" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make "share2" share available to authenticated users
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-the-home-directories-available-to-their-respective-owners" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make the home directories available to their respective owners
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smbexample5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Map remote user "alice.jones" to Linux user "alice"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-make-shares-on-windows-available-to-users-on-sambaclient" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Make shares on "windows" available to users on "sambaclient"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-allow-everyone-to-print-on-all-printers-on-sambaserver" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Allow everyone to print on all printers on "sambaserver"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-disallow-printing-on-printer_1-from-sambaclient" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Disallow printing on "Printer_1" from "sambaclient"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-list-available-services-on-sambaserver" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: List available services on "sambaserver"
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-a-nmbd-wins-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting up a nmbd WINS server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up a nmbd WINS server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-a-wins-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is a WINS Server?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-samba-as-a-wins-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using Samba as a WINS Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using Samba as a WINS Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-logon-scripts-for-clients" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating logon scripts for clients
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#based-on-the-users-name" class="md-nav__link">
    <span class="md-ellipsis">
      
        Based on the user's name
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#based-on-the-clients-name" class="md-nav__link">
    <span class="md-ellipsis">
      
        Based on the client's name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-dns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring DNS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-kerberos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Kerberos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-samba" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Samba
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Samba">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-up-the-smbconf-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting up the smb.conf file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joining-the-domain" class="md-nav__link">
    <span class="md-ellipsis">
      
        Joining the domain
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-the-name-service-switch-nss" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring the Name Service Switch (NSS)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-the-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Starting the services
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-the-winbind-connectivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing the winbind connectivity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>SAMBA Server Configuration (209.1)</h1>

<h2 id="samba-server-configuration-2091">SAMBA Server Configuration (209.1)<a class="headerlink" href="#samba-server-configuration-2091" title="Permanent link">&para;</a></h2>
<h3 id="objective-2091-configuring-a-samba-server-5-points">Objective 209.1; Configuring a Samba Server (5 points)<a class="headerlink" href="#objective-2091-configuring-a-samba-server-5-points" title="Permanent link">&para;</a></h3>
<ul>
<li>Candidates should be able to set up a SAMBA server for various
    clients. This objective includes setting up Samba as a standalone
    and a member server to a Windows Active Directory domain. Both
    setups should be configured to share directories and printers to the
    clients.</li>
</ul>
<h3 id="key-knowledge-areas">Key Knowledge Areas<a class="headerlink" href="#key-knowledge-areas" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Samba 4 documentation</p>
</li>
<li>
<p>Samba configuration files</p>
</li>
<li>
<p>Samba tools and utilities</p>
</li>
<li>
<p>Mounting Samba shares on Linux</p>
</li>
<li>
<p>Samba daemons</p>
</li>
<li>
<p>Mapping Windows usernames to Linux usernames</p>
</li>
<li>
<p>User-Level and Share-Level security</p>
</li>
</ul>
<h3 id="terms-and-utilities">Terms and Utilities<a class="headerlink" href="#terms-and-utilities" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>smbd, nmbd</code></p>
</li>
<li>
<p><code>smbstatus, testparm, smbpasswd, nmblookup</code></p>
</li>
<li>
<p><code>smbclient</code></p>
</li>
<li>
<p><code>samba-tool</code></p>
</li>
<li>
<p><code>net</code></p>
</li>
<li>
<p><code>/etc/smb/</code></p>
</li>
<li>
<p><code>/var/log/samba/</code></p>
</li>
</ul>
<h2 id="what-is-samba">What is Samba?<a class="headerlink" href="#what-is-samba" title="Permanent link">&para;</a></h2>
<p>Samba implements the Server Message Block (SMB) protocol.  This is the protocol
used by Microsoft to implement file and printer sharing. By installing
Samba on a Linux machine, machines running the Windows Operating System
and other platforms for which a SMB client is available can connect to
the Linux machine and thus use files and printers made available by the
Linux machine. Shared resources are also called "shares" or "services".</p>
<p>Samba is available for many platforms including Linux, AIX, HP-UX,
Solaris, FreeBSD, OS/2, AmigaOS. Consult <a href="https://www.samba.org">Samba, Opening Windows To A
Wider World</a>, for further information on platforms
supporting Samba and for downloading a binary or source distribution for
your platform.</p>
<h3 id="installing-the-samba-components">Installing the Samba components<a class="headerlink" href="#installing-the-samba-components" title="Permanent link">&para;</a></h3>
<p>Depending on your distribution, you can</p>
<ul>
<li>
<p>get the sources and compile them yourself</p>
</li>
<li>
<p>install the package using <code>yum</code> or <code>rpm</code> (Red Hat, SuSE etc.)</p>
</li>
<li>
<p>install the package using <code>apt</code>(Debian, Ubuntu)</p>
</li>
</ul>
<p>Samba can be run either from <code>inetd</code> or as daemons. When run
via <code>inetd</code> you can save some memory and use tcpwrappers for extra
security. When run as daemons, the server is always ready and sessions
are faster. If you wish to use encrypted passwords, you will need to
have a separate <code>/etc/samba/smbpasswd</code> file because the layout
sambasmbpasswd differs from <code>/etc/passwd</code>. During installation, you can
choose to have <code>/etc/samba/smbpasswd</code> generated from your <code>/etc/passwd</code>
file. If you choose not to do so, use <code>smbpasswd</code> to set individual
passwords for users.</p>
<p>Samba consists of two daemons:</p>
<ul>
<li>
<p><code>nmbd</code>: the NetBIOS Name Service Daemon which
    handles NetBIOS name lookups and WINS requests. If you've told
    Samba to function as a WINS server, an extra copy of
    <code>nmbd</code> will be running. Additionally, if DNS is used to translate
    NetBIOS names, yet another copy of <code>nmbd</code> will be running.</p>
</li>
<li>
<p><code>smbd</code>: the Server Message Block Daemon which handles file and
    printer access. For each client connected to the server, an extra
    copy of <code>smbd</code> runs.</p>
</li>
</ul>
<p>Samba uses both the UDP and TCP protocols. TCP/139 is used for file and
printer sharing. sambaport 139 UDP is used for the registration and
translation of NetBIOS names, and for browsing the network. UDP/137 is
used for name service requests and sambaport 137 responses. UDP/138 is
used for datagram services to transmit small amounts of data, such as
server announcements.</p>
<h2 id="samba-commands">Samba commands<a class="headerlink" href="#samba-commands" title="Permanent link">&para;</a></h2>
<h3 id="samba-core-commands">Samba core commands<a class="headerlink" href="#samba-core-commands" title="Permanent link">&para;</a></h3>
<h4 id="smbstatus">smbstatus<a class="headerlink" href="#smbstatus" title="Permanent link">&para;</a></h4>
<p>Report on current Samba connections:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c">    $ smbstatus</span>

<span class="c">    Samba version 4</span><span class="nt">.</span><span class="c">1</span><span class="nt">.</span><span class="c">12</span>
<span class="c">    PID     Username      Group         Machine                        </span>
<span class="c">    </span><span class="nb">-------------------------------------------------------------------</span>
<span class="c">    23632     nobody        nobody        10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">24</span><span class="nt">.</span><span class="c">186 (ipv4:10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">24</span><span class="nt">.</span><span class="c">186:49394)</span>

<span class="c">    Service      pid     machine       Connected at</span>
<span class="c">    </span><span class="nb">-------------------------------------------------------</span>
<span class="c">    public       23632   10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">24</span><span class="nt">.</span><span class="c">186  Sat Oct 10 10:15:11 2015</span>

<span class="c">    No locked files</span>
</code></pre></div></td></tr></table></div>

<h4 id="testparm">testparm<a class="headerlink" href="#testparm" title="Permanent link">&para;</a></h4>
<p>Check an smb.conf configuration file for internal correctness.
If <code>testparm</code> finds an error in the <code>smb.conf</code> file it returns an exit
code of 1 to the calling program, else it returns an exit code of 0.
This allows shell scripts to test the output from <code>testparm</code>.</p>
<p>Useful command line options:</p>
<p>-s</p>
<ul>
<li>Print service definitions without prompting for a carriage return</li>
</ul>
<p>-v</p>
<ul>
<li>List all options; by default only the ones specified in <code>smb.conf</code>
    are listed</li>
</ul>
<h4 id="smbpasswd">smbpasswd<a class="headerlink" href="#smbpasswd" title="Permanent link">&para;</a></h4>
<p>Change a user's SMB password. By default (when run with no
arguments) <code>smbpasswd</code> will attempt to change the current user's SMB
password on the local machine. This is similar to the way the
<code>passwd</code>(1) program works. When run by root it can be used to manage
user accounts in the configured password backend. Please note that even
though this utility is called <code>smbpasswd</code> it doesn't necessarily write
the changes to the <code>smbpasswd</code> file. <code>smbpasswd</code> works on the <code>passdb 
                    backend</code> configured in <code>smb.conf</code>. See also <a href="#passdb_backend">Account
information databases</a>.</p>
<p>Command line usage:</p>
<p>as root:</p>
<ul>
<li>smbpasswd [options] [username]</li>
</ul>
<p>as ordinary user:</p>
<ul>
<li>smbpasswd [options]</li>
</ul>
<p>Useful command line options:</p>
<p>-a</p>
<ul>
<li>Add a new user to the password database.</li>
</ul>
<p>-x</p>
<ul>
<li>Remove user from database</li>
</ul>
<h4 id="nmblookup">nmblookup<a class="headerlink" href="#nmblookup" title="Permanent link">&para;</a></h4>
<p>Is used to query NetBIOS names and map them to IP addresses in
a network using NetBIOS over TCP/IP queries. The options of this command
allow the name queries to be directed at a particular IP broadcast area
or to a particular machine. All queries are done over UDP.</p>
<p>Useful command line options:</p>
<p>-M</p>
<ul>
<li>Search master browser.</li>
</ul>
<p>-R</p>
<ul>
<li>Recursion. When using nmblookup to directly query a WIINS server
    with the UNICAST command line option recursion is needed to have the
    WINS server respond to queries not related to its own netbios name
    or IP address. Without recursion set the WINS server will only
    respond with its own netbios name.</li>
</ul>
<p>-U \&lt;unicast address&gt;</p>
<ul>
<li>Send the query to the given UNICAST address (of a WINS server)
    instead of broadcasting the query. Example: "nmblookup -R -U
    10.10.10.2 clientname"</li>
</ul>
<h4 id="smbclient">smbclient<a class="headerlink" href="#smbclient" title="Permanent link">&para;</a></h4>
<p>Is a client that can connect to an SMB/CIFS server. It offers
an interface similar to that of the ftp program (see ftp(1)). Operations
include actions like getting files from the server to the local machine,
putting files from the local machine to the server, retrieving directory
information from the server and so on.</p>
<p>Useful command line options:</p>
<p>-L \&lt;netbios name/IP&gt;</p>
<ul>
<li>List services available on the server responding to the given
    netbios name.</li>
</ul>
<p>-I \&lt;IP address&gt;</p>
<ul>
<li>Connect to given IP address directly instead of querying the network
    for the IP address of the given netbios name.</li>
</ul>
<p>-c \&lt;command&gt;</p>
<ul>
<li>Run given SMB command on the server. One implementation is printing
    with smbclient.</li>
</ul>
<p>-U</p>
<ul>
<li>Connect as the given user.</li>
</ul>
<h4 id="samba-tool">samba-tool<a class="headerlink" href="#samba-tool" title="Permanent link">&para;</a></h4>
<p>Samba-tool is the main administration tool available with
samba4. It can be used to configure and manage all aspects of the samba
server when it is configured as an Active Directory Domain Controller
(AD DC). Even though the manpages currently state otherwise, it is not
supported to use <code>samba-tool</code> to configure the server as a domain member
or standalone server. These options will be removed in a future version
of samba-tool. Note that this tool will not be available on all systems
when installed using the packages. For example, on RHEL7 and CentOS 7,
it will only be available when Samba4 is installed from source.</p>
<p>A short list of the commands and what the are for is shown below. For a
full list of the options for the commands you can view the manpage or
the <a href="https://www.samba.org/samba/docs/man/manpages-3/samba-tool.8.html">online
manpages</a></p>
<p>dbcheck</p>
<ul>
<li>To check to local AD database for errors.</li>
</ul>
<p>delegation</p>
<ul>
<li>To manage delegations.</li>
</ul>
<p>dns</p>
<ul>
<li>To manage the DNS records.</li>
</ul>
<p>domain</p>
<ul>
<li>To manage domain options, for example creating an AD DC.</li>
</ul>
<p>drs</p>
<ul>
<li>To manage Directory Replication Services (DRS).</li>
</ul>
<p>dsacl</p>
<ul>
<li>To manage DS ACLs.</li>
</ul>
<p>fsmo</p>
<ul>
<li>For manage Flexible Single Master Operations (FSMO).</li>
</ul>
<p>gpo</p>
<ul>
<li>To manage Group Policy Objects (GPO).</li>
</ul>
<p>group</p>
<ul>
<li>To manage or create groups.</li>
</ul>
<p>ldapcmp</p>
<ul>
<li>To compare two LDAP databases.</li>
</ul>
<p>ntacl</p>
<ul>
<li>To manage NT ACLs.</li>
</ul>
<p>rodc</p>
<ul>
<li>To manage Read-Only Domain Controllers (RODC)</li>
</ul>
<p>sites</p>
<ul>
<li>To manage sites.</li>
</ul>
<p>spn</p>
<ul>
<li>To manage Service Principal Names (SPN).</li>
</ul>
<p>testparm</p>
<ul>
<li>To check the configuration files.</li>
</ul>
<p>time</p>
<ul>
<li>To retrieve to time on a server.</li>
</ul>
<p>user</p>
<ul>
<li>To manage or create users.</li>
</ul>
<h4 id="net">net<a class="headerlink" href="#net" title="Permanent link">&para;</a></h4>
<p>net samba remote administration Tool for administration of Samba and
remote CIFS servers. The Samba <code>net</code> utility is meant to work just like
the net utility available for windows and DOS. The first argument should
be used to specify the protocol to use when executing a certain command.
ADS is used for ActiveDirectory, RAP is using for old (Win9x/NT3)
clients and RPC can be used for NT4 and Windows. If this argument is
omitted, <code>net</code> will try to determine it automatically. Not all commands
are available on all protocols.</p>
<p>The functionality of the <code>net</code> is too extensive to cover in this
section. Have a look at <code>man 
                    net</code> or <code>net help</code> to show a list of available
commands and command line options. <code>net help 
                    &lt;command&gt;</code> will give command specific information:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="n">help</span><span class="w"> </span><span class="k">user</span>

<span class="w">    </span><span class="n">net</span><span class="w"> </span><span class="o">[</span><span class="n">&lt;method&gt;</span><span class="o">]</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">[</span><span class="n">misc. options</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">targets</span><span class="o">]</span>
<span class="w">        </span><span class="n">List</span><span class="w"> </span><span class="n">users</span>

<span class="w">    </span><span class="n">net</span><span class="w"> </span><span class="o">[</span><span class="n">&lt;method&gt;</span><span class="o">]</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">misc. options</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">targets</span><span class="o">]</span>
<span class="w">        </span><span class="k">Delete</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">user</span>

<span class="w">    </span><span class="n">net</span><span class="w"> </span><span class="o">[</span><span class="n">&lt;method&gt;</span><span class="o">]</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">misc. options</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">targets</span><span class="o">]</span>
<span class="w">        </span><span class="n">List</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">domain</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">user</span>

<span class="w">    </span><span class="n">net</span><span class="w"> </span><span class="o">[</span><span class="n">&lt;method&gt;</span><span class="o">]</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">password</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">-c container</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">-F user flags</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">misc. options</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">targets</span><span class="o">]</span>
<span class="w">        </span><span class="k">Add</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">user</span>

<span class="w">    </span><span class="n">net</span><span class="w"> </span><span class="o">[</span><span class="n">&lt;method&gt;</span><span class="o">]</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">RENAME</span><span class="w"> </span><span class="o">&lt;</span><span class="n">oldusername</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">newusername</span><span class="o">&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">targets</span><span class="o">]</span>
<span class="w">        </span><span class="n">Rename</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">user</span>

<span class="w">    </span><span class="n">Valid</span><span class="w"> </span><span class="nl">methods</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">auto</span><span class="o">-</span><span class="n">detected</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="p">)</span>
<span class="w">        </span><span class="n">ads</span><span class="w">             </span><span class="n">Active</span><span class="w"> </span><span class="n">Directory</span><span class="w"> </span><span class="p">(</span><span class="n">LDAP</span><span class="o">/</span><span class="n">Kerberos</span><span class="p">)</span>
<span class="w">        </span><span class="n">rpc</span><span class="w">             </span><span class="n">DCE</span><span class="o">-</span><span class="n">RPC</span>
<span class="w">        </span><span class="n">rap</span><span class="w">             </span><span class="n">RAP</span><span class="w"> </span><span class="p">(</span><span class="n">older</span><span class="w"> </span><span class="n">systems</span><span class="p">)</span>

<span class="w">    </span><span class="n">Valid</span><span class="w"> </span><span class="nl">targets</span><span class="p">:</span><span class="w"> </span><span class="nf">choose</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="p">(</span><span class="k">none</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">localhost</span><span class="p">)</span>
<span class="w">        </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--server=&lt;server&gt;       server name</span>
<span class="w">        </span><span class="o">-</span><span class="n">I</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--ipaddress=&lt;ipaddr&gt;    address of target server</span>
<span class="w">        </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--workgroup=&lt;wg&gt;        target workgroup or domain</span>

<span class="w">    </span><span class="n">Valid</span><span class="w"> </span><span class="n">miscellaneous</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="k">are</span><span class="err">:</span>
<span class="w">        </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--port=&lt;port&gt;       connection port on target</span>
<span class="w">        </span><span class="o">-</span><span class="n">W</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--myworkgroup=&lt;wg&gt;  client workgroup</span>
<span class="w">        </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--debuglevel=&lt;level&gt;    debug level (0-10)</span>
<span class="w">        </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--myname=&lt;name&gt;     client name</span>
<span class="w">        </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--user=&lt;name&gt;       user name</span>
<span class="w">        </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--configfile=&lt;path&gt; pathname of smb.conf file</span>
<span class="w">        </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--long            Display full information</span>
<span class="w">        </span><span class="o">-</span><span class="n">V</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--version         Print samba version information</span>
<span class="w">        </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--machine-pass        Authenticate as machine account</span>
<span class="w">        </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--encrypt         Encrypt SMB transport (UNIX extended servers only)</span>
<span class="w">        </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--kerberos        Use kerberos (active directory) authentication</span>
<span class="w">        </span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--comment=&lt;comment&gt; descriptive comment (for add only)</span>
<span class="w">        </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="c1">--container=&lt;container&gt; LDAP container, defaults to cn=Users (for add in ADS only)</span>
</code></pre></div></td></tr></table></div>

<p>Using <code>net</code> to get a list of shares from server "sambaserver":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="p">$</span><span class="w"> </span><span class="nv">net</span><span class="w"> </span><span class="o">-</span><span class="nv">S</span><span class="w"> </span><span class="nv">sambaserver</span><span class="w"> </span><span class="o">-</span><span class="nv">U</span><span class="w"> </span><span class="nv">alice</span><span class="w"> </span><span class="nv">share</span>
<span class="w">    </span><span class="nv">Enter</span><span class="w"> </span><span class="nv">alice</span><span class="o">&#39;</span><span class="nv">s</span><span class="w"> </span><span class="nv">password</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="nv">public</span>
<span class="w">    </span><span class="nv">share1</span>
<span class="w">    </span><span class="nv">share2</span>
<span class="w">    </span><span class="nv">Printer_1</span>
<span class="w">    </span><span class="nv">IPC</span><span class="p">$</span>
<span class="w">    </span><span class="nv">alice</span>
<span class="w">    </span><span class="nv">Printer_2</span>
</code></pre></div></td></tr></table></div>

<p>Using <code>net</code> to get the current time of server "sambaserver":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    $ net -S sambaserver time
    Sat Oct 10 10:10:04 2015
</code></pre></div></td></tr></table></div>

<h3 id="commands-not-part-of-the-samba-core">Commands not part of the Samba core<a class="headerlink" href="#commands-not-part-of-the-samba-core" title="Permanent link">&para;</a></h3>
<h4 id="smbmount">smbmount<a class="headerlink" href="#smbmount" title="Permanent link">&para;</a></h4>
<p>smbmount <em>NOTE:</em> Even though <code>smbmount</code> has been abandoned by most major
Linux distributions in favor of <code>mount.cifs</code> you can still expect
questions about <code>smbmount</code> during your LPIC2 exam.</p>
<p>smbfs Even as <code>smbmount</code> was maintained by the Samba community is was
not a part of the core samba-client packages. The "smbfs" package
contains the <code>smbmount</code> command and must be installed to be able to use
smbmount.</p>
<p><code>smbmount</code> is used to mount file systems shared over SMB. Most probably
these file systems are found on Windows systems and shared with Linux
systems with SMB client software installed. <code>smbmount</code> is the command
line utility for mounting SMB file systems. For a more permanent
implementation the <code>smbfs</code> is available for use in <code>/etc/fstab</code>.</p>
<p>Both methods to mount SMB file systems accept options to determine how
the file system is mounted. The most common options are listed here:</p>
<p>username</p>
<ul>
<li>Define username for authentication of the SMB session.</li>
</ul>
<p>password</p>
<ul>
<li>Define password for authentication of the SMB session.</li>
</ul>
<p>credentials</p>
<ul>
<li>This option points to a file containing a username and password. Use
    of this option is prefered over using the username and password in
    the command line options or in <code>/etc/fstab</code>. This file must have
    proper protection so only the user and/or root can read it.<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    username=value
    password=value
</code></pre></div></td></tr></table></div>

</li>
</ul>
<p>uid</p>
<ul>
<li>Define UID used for the local representation of the files on the
    mounted file system.</li>
</ul>
<p>gid</p>
<ul>
<li>Define GID used for the local representation of the files on the
    mounted file system.</li>
</ul>
<p>fmask</p>
<ul>
<li>
<p>Define permissions of remote files in the local representation of
    the mounted file system. This doesn't affect the actual permissions
    on the remote server.</p>
<p>Important: The name of the option is deceptive. It's not a <em>mask</em>
but the actual permissions that is defined.</p>
</li>
</ul>
<p>dmask</p>
<ul>
<li>
<p>Define permissions of remote directories in the local representation
    of the mounted file system. This doesn't affect the actual
    permissions on the remote server.</p>
<p>Important: The name of the option is deceptive. It's not a <em>mask</em>
but the actual permissions that is defined.</p>
</li>
</ul>
<p>rw/ro</p>
<ul>
<li>Mount the filesystem read-write or read-only.</li>
</ul>
<p>Example command line usage:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    smbmount //windows/winshare2 /opt/winshare2 -o \ 
        username=alice.jones,password=Alice,uid=nobody,gid=nobody,fmask=775,dmask=775,rw,hard
</code></pre></div></td></tr></table></div>

<p>Example of <code>/etc/fstab</code> usage:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="c1">//windows/winshare2 /opt/winshare2 smbfs \ </span>
<span class="w">        </span><span class="n">username</span><span class="p">=</span><span class="n">alice</span><span class="p">.</span><span class="n">jones</span><span class="p">,</span><span class="n">password</span><span class="p">=</span><span class="n">Alice</span><span class="p">,</span><span class="n">uid</span><span class="p">=</span><span class="n">nobody</span><span class="p">,</span><span class="n">gid</span><span class="p">=</span><span class="n">nobody</span><span class="p">,</span><span class="n">fmask</span><span class="p">=</span><span class="mi">775</span><span class="p">,</span><span class="n">dmask</span><span class="p">=</span><span class="mi">775</span><span class="p">,</span><span class="n">rw</span><span class="p">,</span><span class="n">hard</span><span class="w"> </span><span class="p">:</span><span class="c1">//windows/winshare2 0 0</span>
</code></pre></div></td></tr></table></div>

<h3 id="samba-logging">Samba logging<a class="headerlink" href="#samba-logging" title="Permanent link">&para;</a></h3>
<p>Samba by default writes logging to files in the <code>/var/log/samba/</code>
directory:</p>
<ul>
<li>
<p>log.nmbd</p>
</li>
<li>
<p>Logging from the Netbios name lookup daemon.</p>
</li>
<li>
<p>log.smbd</p>
<ul>
<li>Logging from the SMB daemon.</li>
</ul>
</li>
</ul>
<p>Logging can be configured with global parameters in the Samba
configuration. See <a href="#smbconfigparams">Configuration parameters</a> for a
few of the most useful parameters.</p>
<h3 id="account-information-databases">Account information databases<a class="headerlink" href="#account-information-databases" title="Permanent link">&para;</a></h3>
<p>Samba can be configured to use different backends to
store or retrieve account information. The most important are desribed
here. Smb.conf configuration option: "passwd backend".</p>
<h4 id="smbpasswd_1">smbpasswd<a class="headerlink" href="#smbpasswd_1" title="Permanent link">&para;</a></h4>
<p>With the <code>smbpasswd</code> method a plain text file contains
all account information. Passwords are encrypted.</p>
<p>Drawbacks to using <code>smbpasswd</code>:</p>
<ul>
<li>
<p>Doesn't scale.</p>
</li>
<li>
<p>No replication.</p>
</li>
<li>
<p>Lacks storage of Windows information (RIDs or NT groups).</p>
</li>
</ul>
<p>Usage of <code>smbpasswd</code> is not recommended because it does not scale well
or hold any Windows information.</p>
<h4 id="tdbsam">tdbsam<a class="headerlink" href="#tdbsam" title="Permanent link">&para;</a></h4>
<p><code>tdbsam</code> also lacks scalability because it's just a local
database (Trivial database) that doesn't support replication. One
advantage of <code>tdbsam</code> over <code>smbpasswd</code> is its capabillity to also store
Windows information with the accounts.</p>
<p>Usage of <code>tdbsam</code> is not recommended for enterprise environments because
it does not scale well and (FIXME what does he mean?) holds any Windows information. Tdbsam can be
used for standalone Samba servers with a recommended maximum of 250
users.</p>
<h4 id="ldapsam">ldapsam<a class="headerlink" href="#ldapsam" title="Permanent link">&para;</a></h4>
<p>In enterprise environments the usage of <code>ldapsam</code> is
recommended. <code>Ldapsam</code> uses LDAP as backend and LDAP is highly scalable.</p>
<h2 id="samba-configuration">Samba configuration<a class="headerlink" href="#samba-configuration" title="Permanent link">&para;</a></h2>
<h3 id="samba-configuration-directory-etcsmb-or-etcsamba">Samba configuration directory <code>/etc/smb</code> or <code>/etc/samba</code>.<a class="headerlink" href="#samba-configuration-directory-etcsmb-or-etcsamba" title="Permanent link">&para;</a></h3>
<p>The LPI objectives ask for knowledge about <code>/etc/smb/</code>. In some
distributions <code>/etc/samba/</code> is used instead. Files and folders that
exist in <code>/etc/smb/</code> or <code>/etc/samba/</code> are:</p>
<ul>
<li>
<p><code>lmhosts</code> - The Samba NetBIOS hosts file;</p>
</li>
<li>
<p><code>smb.conf</code> - The configuration file for the Samba suite;</p>
</li>
<li>
<p><code>netlogon</code> - The logon directory for user logon.</p>
</li>
</ul>
<h3 id="smbconf">smb.conf<a class="headerlink" href="#smbconf" title="Permanent link">&para;</a></h3>
<p>Samba is configured via <code>/etc/samba/smbd.conf</code>. This file consists of
sections containing configuration options. The name of the section is
the name of the shared resource.</p>
<h4 id="special-sections">special sections<a class="headerlink" href="#special-sections" title="Permanent link">&para;</a></h4>
<p>There are three special sections within the samba configuration file:</p>
<p>[global]
-   samba
    global
    Global Samba configuration</p>
<p>[homes]
-   samba
    homes
    Special section: definition of home directories</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code>Home directories can be accessed by using the user name as service,
or by directly accessing the &quot;homes&quot; service:

        smbclient //sambaserver/alice -U alice
        smbclient //sambaserver/homes -U alice


Both these commands will result in access to the home directory of
user &quot;alice&quot;.
</code></pre></div></td></tr></table></div>

<p>[printers]
-   samba
    printers
    Special resource or service: global configuration to enable access
    to all printers</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Note</span><span class="o">:</span><span class="w"> </span><span class="n">individual</span><span class="w"> </span><span class="n">printers</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">service</span>
<span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n n-Quoted">`printable`</span><span class="w"> </span><span class="n">parameter</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>

<h4 id="configuration-parameters">Configuration parameters<a class="headerlink" href="#configuration-parameters" title="Permanent link">&para;</a></h4>
<p>In this section the most important configuration options are explained,
grouped by Samba configuration section (type). Most can also be found in
the examples section further on.</p>
<p>The smb.conf man pages divide parameters into two groups:</p>
<p>global</p>
<ul>
<li>Parameters that can only be used in the <code>[global]</code> sections of the
    Samba configuration.</li>
</ul>
<p>services</p>
<ul>
<li>
<p>Parameters that are used in service sections of the Samba
    configuration.</p>
<p>Some of these paramaters can also be used globally.</p>
</li>
</ul>
<h4 id="global">[global]<a class="headerlink" href="#global" title="Permanent link">&para;</a></h4>
<p>The <code>[global]</code> section contains global parameters, but it is also used
to set service parameters in a global context (providing default values
if the parameter is not set for a specific service).</p>
<p>netbios name</p>
<ul>
<li>This option sets the NetBIOS name by which the Samba server is
    known. This name will be the name that services are advertised
    under. By default it is the same as the system's hostname.</li>
</ul>
<p>netbios aliases</p>
<ul>
<li>This option sets an alias by which the Samba server is alternatively
    known.</li>
</ul>
<p>log file</p>
<ul>
<li>This option dictates to what file(s) logging is written. The file
    name accepts macros enabling for instance writting a log file per
    client: <code>/var/log/samba/log.%m</code>.</li>
</ul>
<p>workgroup</p>
<ul>
<li>Server and clients must be members of the same workgroup.</li>
</ul>
<p>realm</p>
<ul>
<li>This option specifies the kerberos realm to use. The realm is used
    as the ADS equivalent of the NT4 domain.</li>
</ul>
<p>server string</p>
<ul>
<li>Any string you want to apear in list contexts.</li>
</ul>
<p>encrypt passwords</p>
<ul>
<li>Windows encrypts passwords. This option will also need to be turned
    on for Samba.</li>
</ul>
<p>security</p>
<ul>
<li>This option determines what security mode to use. Most commonly used
    is <code>user</code> for standalone file servers or Samba servers that also
    function as a DC. If the Samba server is connected to a Windows
    domain this option must be set to <code>ads</code> or <code>domain</code>.</li>
</ul>
<p>unix password sync</p>
<ul>
<li>This boolean parameter in the <code>[global]</code> section controls whether
    Samba attempts to synchronize the UNIX password with the SMB
    password when the encrypted SMB password in the <code>smbpasswd</code> file is
    changed. If this is set to yes (unix password sync = yes), the
    program specified in the <code>passwd</code> program parameter is called AS
    ROOT - to allow the new UNIX password to be set without access to
    the old UNIX password (as the SMB password change code has no access
    to the old cleartext password).</li>
</ul>
<p>passdb backend</p>
<ul>
<li>
<p>This option determines what account/password backend is used. See
    also <a href="#passdb_backend">Account information databases</a></p>
<p>Mostly used options are:</p>
<p>smbpasswd[:argument]</p>
<p>:   Old plaintext passdb backend. Optionally takes a path to the
    smbpasswd file as an argument.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>Example: `passdb backend = 
                                                        smbpasswd:/etc/samba/smbpasswd`
</code></pre></div></td></tr></table></div>

<p>tdbsam[:argument]</p>
<p>:   TDB based password storage backend. Optionally takes a path to
    the TDB file as an argument.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>Example: `passdb backend = 
                                                        tdbsam:/etc/samba/private/passdb.tdb`
</code></pre></div></td></tr></table></div>

<p>ldapsam[:argument]</p>
<p>:   LDAP backend. Optionally takes an LDAP URL as an argument.
    (defaults to "ldap://localhost")</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>Example: `passdb backend = 
                                                        ldapsam:ldap://localhost`
</code></pre></div></td></tr></table></div>

</li>
</ul>
<p>username map</p>
<ul>
<li>
<p>samba username map This option in the <code>[global]</code> section allows you
    to map the client supplied username to another username on the
    server. The most common usage is to map usernames used on DOS or
    Windows machines to those used on the UNIX system. Another usage is
    to map multiple users to a single username so that they can more
    easily share files. The username map is a file where each line
    should contain a single UNIX username on the left then a "="
    followed by a space-delimited list of usernames on the right. Quotes
    must be used to specify a username that includes a space. The list
    of usernames on the right may contain names of the form \@group in
    which case they will match any UNIX username in that group. The
    special client name "*" is a wildcard and can be used to match
    unknown names to a known user. Each line of the map file may be up
    to 1023 characters long. If a line begins with a "!" then the
    processing will stop at that point if it matches a name. This is
    useful for lines used before a wildcard otherwise names will still
    be mapped to the one using the wildcard.</p>
<p>Here is an example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    username map = /usr/local/samba/private/usermap.txt
</code></pre></div></td></tr></table></div>

<p>Example content of <code>usermap.txt</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">administraor</span><span class="w"> </span><span class="k">admin</span>
<span class="w">    </span><span class="n">nobody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="n">pcguest</span><span class="w"> </span><span class="n">smbguest</span>
<span class="w">    </span><span class="n">alice</span><span class="p">.</span><span class="n">jones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alice</span>
<span class="w">    </span><span class="n">readonly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glen</span><span class="w"> </span><span class="n">fred</span><span class="w"> </span><span class="n">terry</span><span class="w"> </span><span class="n">sarah</span>
<span class="w">    </span><span class="n">lachlan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Lachlan Smith&quot;</span>
<span class="w">    </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@sales</span>
</code></pre></div></td></tr></table></div>

</li>
</ul>
<p>guest ok</p>
<ul>
<li>This parameter configures guest access for a service.</li>
</ul>
<p>map to guest</p>
<ul>
<li>
<p>Is guest access is enabled this option determines what sessions are
    mapped to guest access. Available values are:</p>
<ul>
<li>
<p>Never</p>
</li>
<li>
<p>Bad User</p>
</li>
<li>
<p>Bad Password</p>
</li>
<li>
<p>Bad Uid (only available in ADS or DOMAIN security mode)</p>
</li>
</ul>
</li>
</ul>
<h4 id="service-sections">service sections<a class="headerlink" href="#service-sections" title="Permanent link">&para;</a></h4>
<p>The following parameters are used in service definitions (both special
as normal services).</p>
<p>path</p>
<ul>
<li>
<p>The context in which this parameter is used determines how it is
    interpreted:</p>
<ul>
<li>
<p>In the <code>[homes]</code> section it specifies the path to the directory
    that must be served as the users home directories. If omitted
    the home directory defaults to the system's home directory. If
    used this parameter must contain the "%S" macro, expanding to
    the username.</p>
</li>
<li>
<p>In a section that is set to be <code>printable</code> this parameter points
    to the directory where printer spool files are written prior to
    being sent to the print queue. This directory must be
    world-writable and have the sticky bit set if the printer is
    configured for guest access.</p>
</li>
<li>
<p>In a <code>share</code> definition this parameter points to the directory
    the share must give access to.</p>
</li>
</ul>
</li>
</ul>
<p>comment</p>
<ul>
<li>Text field showing in service listings.</li>
</ul>
<p>printer name</p>
<ul>
<li>Points to a local print queue when configuring an individual
    printer.</li>
</ul>
<p>printable</p>
<ul>
<li>Declares a service as a printer.</li>
</ul>
<p>browseable</p>
<ul>
<li>Makes service browseable. A client can browse to a service instead
    of having to know the full path to the service.</li>
</ul>
<p>guest ok</p>
<ul>
<li>Guest access is enabled for this service (or globally).</li>
</ul>
<p>(in)valid users</p>
<ul>
<li>Provide a list of users that are allowed access (<code>valid users</code>) to
    this service, or that are denied access (<code>invalid users</code>). Names
    starting with a "@" are interpreted as a NIS netgroup or a Unix
    group. When a name starts with a "+" the nsswitch mechanism is used
    to find the group. With a "&amp;" the group will only bee looked up in
    NIS. See the manual for more information.</li>
</ul>
<p>hosts allow|deny</p>
<ul>
<li>Provide a list of clients that can be granted (<code>hosts allow</code>) or
    denied (<code>hosts deny</code>) access. Names can be IP addresses, networks or
    host names. Names started with a "@" are NIS netgroups.</li>
</ul>
<p>writable</p>
<ul>
<li>Determines if a user is allowed to write to this service. Defaults
    to "no".</li>
</ul>
<p>Security levels and modes</p>
<p>Samba knows two security levels: "user-level" and "share-level". The
server will inform the client of the security level and the client will
respond in correspondance with the choosen level. The security <em>level</em>
is determined by setting the security <em>mode</em>.</p>
<p>The security mode is a Global setting.</p>
<h4 id="user-level-security">User-level security<a class="headerlink" href="#user-level-security" title="Permanent link">&para;</a></h4>
<p>User-level security means that each connection is authenticated by a
username and password combination which has to match with authorizations
on the requested service. For "user-level" security the server can be
set up in three modes:</p>
<p>user</p>
<ul>
<li>
<p><code>security = user</code></p>
<p>Samba is running as a standalone server and will use a local
password database.</p>
</li>
</ul>
<p>ads</p>
<ul>
<li>
<p><code>security = ads</code></p>
<p>Samba will act as a Active Directory domain member in an ADS realm.</p>
</li>
</ul>
<p>domain</p>
<ul>
<li>
<p><code>security = domain</code></p>
<p>Samba will validate the username/password to a Windows NT Primary or
Backup Domain Controller.</p>
</li>
</ul>
<h4 id="share-level-security">Share-level security<a class="headerlink" href="#share-level-security" title="Permanent link">&para;</a></h4>
<p><code>security = share</code></p>
<p>With share-level security the client expects a password to be associated
with each share, independent of the user. With share-level security the
client will only pass the password provided by the remote user and does
so for each seperate share. The Samba sever will then try to match the
password to a confgured list of users (if provided for the share that's
affected), or will use system calls (looking in nsswitch.conf or
/etc/passwd) to find a Linux account matching the provided password.</p>
<p>Share-level service parameters:</p>
<p>only user</p>
<ul>
<li>
<p><code>only user - yes</code></p>
<p>Only the users listed in <code>username</code> have access to this service. If
not any user matching the provided password is given access.</p>
</li>
</ul>
<p>username</p>
<ul>
<li>
<p><code>username = fred, alice</code></p>
<p>Determines which users have access to this service.</p>
</li>
</ul>
<p>Note: Because with share-level security the password to access a share
is not known by just one person but by everyone who needs access
share-level security is considered to be insecure and therefor support
for share-level security has been removed from Samba version 4.</p>
<p><strong>Examples</strong></p>
<p>The following image decribed the environment used to implement the
examples described below.</p>
<p><img alt="" src="../images/209-ourgroup.dot.svg.jpg" /></p>
<p>We've got three machines connected via a network on which we want to
accomplish the following:</p>
<ul>
<li>
<p>The machines "sambaserver" and "windows" contain files the other
    machines must be able to manipulate.</p>
</li>
<li>
<p>All machines must be able to use the printer connected to
    "sambaserver".</p>
</li>
<li>
<p>"sambaserver" is running Linux and has Samba installed.</p>
</li>
<li>
<p>"windows" is running Microsoft Windows.</p>
</li>
<li>
<p>"sambaclient" is running Linux and has <code>smbclient</code> installed to be
    able to function as a Samba client.</p>
</li>
<li>
<p>We want to share only parts of the resources on "sambaserver" and
    "windows".</p>
<ul>
<li>
<p><a href="#smbexample1">Make share public available to everyone</a></p>
</li>
<li>
<p><a href="#smbexample2">Make share share1 available to alice</a></p>
</li>
<li>
<p><a href="#smbexample3">Make share share2 available to authenticated
    users</a></p>
</li>
<li>
<p><a href="#smbexample4">Make the home directories available to their respective
    owners</a></p>
</li>
<li>
<p><a href="#smbexample5">Map remote user alice.jones to user alice</a></p>
</li>
<li>
<p><a href="#smbexample6">Make shares on windows available to users on
    sambaclient</a></p>
</li>
<li>
<p><a href="#smbexample7">Allow everyone to print on all printers on
    sambaserver</a></p>
</li>
<li>
<p><a href="#smbexample8">Disallow printing on Printer_1 from sambaclient</a></p>
</li>
<li>
<p><a href="#smbexample9">List available services on sambaserver</a></p>
</li>
</ul>
</li>
</ul>
<h3 id="basic-global-section-to-support-the-examples">Basic [global] section to support the examples<a class="headerlink" href="#basic-global-section-to-support-the-examples" title="Permanent link">&para;</a></h3>
<p>Basic global section needed to support the following examples:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">global</span><span class="o">]</span>
<span class="w">      </span><span class="n">workgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OURGROUP</span>
<span class="w">      </span><span class="n">server</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">Samba</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="o">%</span><span class="n">L</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">LPIC2</span><span class="w"> </span><span class="n">examples</span>
<span class="w">      </span><span class="n">encrypt</span><span class="w"> </span><span class="n">passwords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">user</span>
<span class="w">      </span><span class="n">netbios</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sambaserver</span>
<span class="w">      </span><span class="n">netbios</span><span class="w"> </span><span class="n">aliases</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss2</span>
<span class="w">      </span><span class="nf">log</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="nf">log</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="nf">log</span><span class="p">.</span><span class="o">%</span><span class="n">m</span>
<span class="w">      </span><span class="k">map</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="k">user</span>
<span class="w">      </span><span class="n">hosts</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">valid</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
</code></pre></div></td></tr></table></div>

<h3 id="example-make-public-share-available-to-everyone">Example: Make "public" share available to everyone<a class="headerlink" href="#example-make-public-share-available-to-everyone" title="Permanent link">&para;</a></h3>
<p>The configuration section inserted or modified to implement this
example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">public</span><span class="o">]</span>
<span class="w">      </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Public</span><span class="w"> </span><span class="n">Storage</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">%</span><span class="n">L</span>
<span class="w">      </span><span class="k">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">export</span><span class="o">/</span><span class="k">public</span>
<span class="w">      </span><span class="n">browsable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">writeable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>
<p>The section <code>[public]</code> is added.</p>
</li>
<li>
<p>The path that is made accessible by this service is
    <code>/export/public</code>.</p>
</li>
<li>
<p>The service is made browsable so a client can browse to the service
    by connecting directly to the Samba server.</p>
</li>
<li>
<p>The service is made writable.</p>
</li>
<li>
<p>Guest access is enabled so no authentication is needed.</p>
</li>
<li>
<p><code>valid users</code> is not set and the global value is used (defaults to
    "all authenticated users"): all authenticated users have access.</p>
</li>
</ul>
<p>All authenticated users have access and users that can not be
authenticated will get access as "guest".</p>
<p>Create a test file, connect with account "jack" that cannot be
authenticated (effectively a "guest"), check the active share and copy
the test file to the share.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">touch</span><span class="w"> </span><span class="n">jack</span><span class="p">.</span><span class="n">txt</span>
<span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="k">public</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">jack</span><span class="w"> </span><span class="o">-</span><span class="n">N</span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">volume</span>
<span class="w">    </span><span class="nl">Volume</span><span class="p">:</span><span class="w"> </span><span class="o">|</span><span class="k">public</span><span class="o">|</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0x2b5c2e91</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">jack</span><span class="p">.</span><span class="n">txt</span>
<span class="w">    </span><span class="n">putting</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">jack</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">\</span><span class="n">jack</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="p">(</span><span class="mf">0.0</span><span class="w"> </span><span class="n">kb</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">average</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="n">kb</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ls</span>
<span class="w">      </span><span class="p">.</span><span class="w">                                   </span><span class="n">D</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Wed</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">16</span><span class="err">:</span><span class="mi">57</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="p">..</span><span class="w">                                  </span><span class="n">D</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Wed</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">44</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="k">public</span><span class="p">.</span><span class="n">txt</span><span class="w">                          </span><span class="n">N</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Wed</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">45</span><span class="err">:</span><span class="mi">07</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">jack</span><span class="p">.</span><span class="n">txt</span><span class="w">                            </span><span class="n">A</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Wed</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">16</span><span class="err">:</span><span class="mi">57</span><span class="w"> </span><span class="mi">2015</span>

<span class="w">            </span><span class="mi">54864</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="mf">131072.</span><span class="w"> </span><span class="mi">47234</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">available</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>

<p>Output of smbstatus showing the session from user "nobody" which is our
(default) configured Linux account for "guest" and checking the test
file on the "public" share:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">$</span><span class="w"> </span><span class="n">smbstatus</span>

<span class="w">    </span><span class="n">Samba</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">4.1</span><span class="o">.</span><span class="mi">12</span>
<span class="w">    </span><span class="n">PID</span><span class="w">     </span><span class="n">Username</span><span class="w">      </span><span class="n">Group</span><span class="w">         </span><span class="n">Machine</span><span class="w">                        </span>
<span class="w">    </span><span class="o">-------------------------------------------------------------------</span>
<span class="w">    </span><span class="mi">24265</span><span class="w">     </span><span class="n">nobody</span><span class="w">        </span><span class="n">nobody</span><span class="w">        </span><span class="mf">10.20</span><span class="o">.</span><span class="mf">27.158</span><span class="w"> </span><span class="p">(</span><span class="n">ipv4</span><span class="p">:</span><span class="mf">10.20</span><span class="o">.</span><span class="mf">27.158</span><span class="p">:</span><span class="mi">49009</span><span class="p">)</span>

<span class="w">    </span><span class="n">Service</span><span class="w">      </span><span class="n">pid</span><span class="w">     </span><span class="n">machine</span><span class="w">       </span><span class="n">Connected</span><span class="w"> </span><span class="n">at</span>
<span class="w">    </span><span class="o">-------------------------------------------------------</span>
<span class="w">    </span><span class="n">public</span><span class="w">       </span><span class="mi">24265</span><span class="w">   </span><span class="mf">10.20</span><span class="o">.</span><span class="mf">27.158</span><span class="w">  </span><span class="n">Wed</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">08</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">48</span><span class="w"> </span><span class="mi">2015</span>

<span class="w">    </span><span class="n">No</span><span class="w"> </span><span class="n">locked</span><span class="w"> </span><span class="n">files</span>
<span class="w">    </span><span class="o">$</span><span class="w"> </span><span class="n">pwd</span>
<span class="w">    </span><span class="o">/</span><span class="k">export</span><span class="o">/</span><span class="n">public</span>
<span class="w">    </span><span class="o">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>
<span class="w">    </span><span class="n">total</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="o">-</span><span class="n">rwxr</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">nobody</span><span class="w"> </span><span class="n">nobody</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">16</span><span class="w"> </span><span class="n">jack</span><span class="o">.</span><span class="n">txt</span>
<span class="w">    </span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">   </span><span class="n">root</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">07</span><span class="p">:</span><span class="mi">45</span><span class="w"> </span><span class="n">public</span><span class="o">.</span><span class="n">txt</span>
</code></pre></div></td></tr></table></div>

<h3 id="example-make-share1-share-available-to-alice">Example: Make "share1" share available to alice<a class="headerlink" href="#example-make-share1-share-available-to-alice" title="Permanent link">&para;</a></h3>
<p>The configuration section inserted or modified to implement this
example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">share1</span><span class="o">]</span>
<span class="w">      </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Share1</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">%</span><span class="n">L</span>
<span class="w">      </span><span class="k">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">export</span><span class="o">/</span><span class="n">share1</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="n">browsable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">writeable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">valid</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alice</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>
<p>The section <code>[share1]</code> is added.</p>
</li>
<li>
<p>The path that is made accessible by this service is
    <code>/export/share2</code>.</p>
</li>
<li>
<p>The service is made browsable so a user can browse to the service by
    directly connecting to the Samba server.</p>
</li>
<li>
<p>The service is made writable.</p>
</li>
<li>
<p><code>guest ok</code> is not set and the global value is used (default = "no"):
    guest access is not allowed.</p>
</li>
<li>
<p><code>valid users</code> is set to "alice" to allow access for the <em>Linux</em> user
    "alice".</p>
</li>
</ul>
<p>Failing attempt to access share1 as fred:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="n">share1</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">fred</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="n">tree</span><span class="w"> </span><span class="k">connect</span><span class="w"> </span><span class="nl">failed</span><span class="p">:</span><span class="w"> </span><span class="n">NT_STATUS_ACCESS_DENIED</span>
</code></pre></div></td></tr></table></div>

<p>Successful attempt to access share1 as alice:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="n">share1</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">alice</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">volume</span>
<span class="w">    </span><span class="nl">Volume</span><span class="p">:</span><span class="w"> </span><span class="o">|</span><span class="n">share1</span><span class="o">|</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0xd62d5fc5</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>

<h3 id="example-make-share2-share-available-to-authenticated-users">Example: Make "share2" share available to authenticated users<a class="headerlink" href="#example-make-share2-share-available-to-authenticated-users" title="Permanent link">&para;</a></h3>
<p>The configuration section inserted or modified to implement this
example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">share2</span><span class="o">]</span>
<span class="w">      </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">%</span><span class="n">S</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">%</span><span class="n">L</span>
<span class="w">      </span><span class="k">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">export</span><span class="o">/</span><span class="n">share2</span>
<span class="w">      </span><span class="n">browsable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">writeable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>
<p>The section <code>[share2]</code> is added.</p>
</li>
<li>
<p>The path that is made accessible by this service is
    <code>/export/share2</code>.</p>
</li>
<li>
<p>The service is made browsable so a user can browse to the service by
    directly connecting to the Samba server.</p>
</li>
<li>
<p>The service is NOT writable.</p>
</li>
<li>
<p><code>guest ok</code> is not set and the global value is used (default = "no"):
    guest access is not allowed.</p>
</li>
<li>
<p><code>valid users</code> is not set and the global value is used (default =
    "empty"): all authenticated users have access.</p>
</li>
</ul>
<p>Because <code>guest ok</code> defaults to the global value of "no" and the empty
<code>valid users</code> defaults to the global value of "any authenticated user"
all (and only) authenticated users have access to "share2"</p>
<p>Failing attempt to access share2 as guest:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="n">share1</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">jack</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="n">tree</span><span class="w"> </span><span class="k">connect</span><span class="w"> </span><span class="nl">failed</span><span class="p">:</span><span class="w"> </span><span class="n">NT_STATUS_ACCESS_DENIED</span>
</code></pre></div></td></tr></table></div>

<p>Successful attempt to access share2 as an authenticated user:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="n">share2</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">alice</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">volume</span>
<span class="w">    </span><span class="nl">Volume</span><span class="p">:</span><span class="w"> </span><span class="o">|</span><span class="n">share2</span><span class="o">|</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0xb954cdf0</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>

<h3 id="example-make-the-home-directories-available-to-their-respective-owners">Example: Make the home directories available to their respective owners<a class="headerlink" href="#example-make-the-home-directories-available-to-their-respective-owners" title="Permanent link">&para;</a></h3>
<p>The configuration section inserted or modified to implement this
example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">homes</span><span class="o">]</span>
<span class="w">      </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">%</span><span class="n">U</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">homedirectory</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">%</span><span class="n">L</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">%</span><span class="n">m</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">browsable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="n">writeable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>
<p>The section <code>[public]</code> is added.</p>
</li>
<li>
<p>The path that is made accessible by this service is
    <code>/export/public</code>.</p>
</li>
<li>
<p>The service is made browsable so a user can browse to the service by
    directly connecting to the Samba server.</p>
</li>
<li>
<p>The service is made writable.</p>
</li>
<li>
<p>Guest access is enabled so no authentication is needed.</p>
</li>
<li>
<p><code>valid users</code> is not set and the global value is used (default =
    "empty"): all authenticated users have access to this special
    service.</p>
</li>
</ul>
<p>As "fred" access your home directory on "sambaserver":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="n">fred</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">fred</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">volume</span>
<span class="w">    </span><span class="nl">Volume</span><span class="p">:</span><span class="w"> </span><span class="o">|</span><span class="n">fred</span><span class="o">|</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0xce0909dd</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>

<p>Output of smbstatus showing the session from user "fred":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c">    $ smbstatus</span>
<span class="c">    Samba version 4</span><span class="nt">.</span><span class="c">1</span><span class="nt">.</span><span class="c">12</span>
<span class="c">    PID     Username      Group         Machine                        </span>
<span class="c">    </span><span class="nb">-------------------------------------------------------------------</span>
<span class="c">    24457     fred          fred          10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">27</span><span class="nt">.</span><span class="c">158 (ipv4:10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">27</span><span class="nt">.</span><span class="c">158:49017)</span>

<span class="c">    Service      pid     machine       Connected at</span>
<span class="c">    </span><span class="nb">-------------------------------------------------------</span>
<span class="c">    fred         24457   10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">27</span><span class="nt">.</span><span class="c">158  Wed Oct 21 09:36:34 2015</span>

<span class="c">    No locked files</span>
</code></pre></div></td></tr></table></div>

<h3 id="smbexample5">Example: Map remote user "alice.jones" to Linux user "alice"<a class="headerlink" href="#smbexample5" title="Permanent link">&para;</a></h3>
<p>Parameter added to the <code>global</code> section:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">global</span><span class="o">]</span>
<span class="w">      </span><span class="p">...</span>
<span class="w">      </span><span class="n">username</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="n">usermap</span><span class="p">.</span><span class="n">txt</span>
<span class="w">      </span><span class="p">...</span>
</code></pre></div></td></tr></table></div>

<p>Sample contents of <code>/usr/local/samba/private/usermap.txt</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">administraor</span><span class="w"> </span><span class="k">admin</span>
<span class="w">    </span><span class="n">nobody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guest</span><span class="w"> </span><span class="n">pcguest</span><span class="w"> </span><span class="n">smbguest</span>
<span class="w">    </span><span class="n">alice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">jones</span>
<span class="w">    </span><span class="n">readonly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glen</span><span class="w"> </span><span class="n">fred</span><span class="w"> </span><span class="n">terry</span><span class="w"> </span><span class="n">sarah</span>
<span class="w">    </span><span class="n">lachlan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Lachlan Smith&quot;</span>
<span class="w">    </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">@sales</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>User mapping is a global setting. Login names (most probably Windows
    account names) are mapped to local (Linux) users.</li>
</ul>
<p>If "alice.jones" tries to connect to the related home directory
"alice.jones" will be mapped to "alice", the user will have access to
all services enabled for "alice" and the home directory for "alice" will
be served instead of "alice.jones".</p>
<p>Connection from "sambaclient" to "sambaserver" as "alice.jones":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span><span class="o">/</span><span class="n">alice</span><span class="p">.</span><span class="n">jones</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">alice</span><span class="p">.</span><span class="n">jones</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">volume</span>
<span class="w">    </span><span class="nl">Volume</span><span class="p">:</span><span class="w"> </span><span class="o">|</span><span class="n">alice</span><span class="o">|</span><span class="w"> </span><span class="n">serial</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mh">0x37da1047</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div>

<p>Output of <code>smbstatus</code> on "sambaserver" showing active connections
doesn't show "alice.jones" but only "alice":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c">    $ smbstatus</span>

<span class="c">    Samba version 4</span><span class="nt">.</span><span class="c">1</span><span class="nt">.</span><span class="c">12</span>
<span class="c">    PID     Username      Group         Machine                        </span>
<span class="c">    </span><span class="nb">-------------------------------------------------------------------</span>
<span class="c">    23788     alice         alice         10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">27</span><span class="nt">.</span><span class="c">158 (ipv4:10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">27</span><span class="nt">.</span><span class="c">158:48988)</span>

<span class="c">    Service      pid     machine       Connected at</span>
<span class="c">    </span><span class="nb">-------------------------------------------------------</span>
<span class="c">    alice        23788   10</span><span class="nt">.</span><span class="c">20</span><span class="nt">.</span><span class="c">27</span><span class="nt">.</span><span class="c">158  Wed Oct 21 07:29:39 2015</span>

<span class="c">    No locked files</span>
</code></pre></div></td></tr></table></div>

<h3 id="example-make-shares-on-windows-available-to-users-on-sambaclient">Example: Make shares on "windows" available to users on "sambaclient"<a class="headerlink" href="#example-make-shares-on-windows-available-to-users-on-sambaclient" title="Permanent link">&para;</a></h3>
<p>Using <code>smbclient</code> to copy a file to <code>winshare1</code> on "windows":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">fred@sambaclient ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">&quot;file from Fred&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">fred</span><span class="p">.</span><span class="n">txt</span>
<span class="w">    </span><span class="o">[</span><span class="n">fred@sambaclient ~</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">windows</span><span class="o">/</span><span class="n">winshare1</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">fred</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">WINDOWS</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Windows 7 Professional 7601 Service Pack 1</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Windows 7 Professional 6.1</span><span class="o">]</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dir</span>
<span class="w">      </span><span class="p">.</span><span class="w">                                  </span><span class="n">DR</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">21</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="p">..</span><span class="w">                                 </span><span class="n">DR</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">21</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">desktop</span><span class="p">.</span><span class="n">ini</span><span class="w">                       </span><span class="n">AHS</span><span class="w">       </span><span class="mi">46</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">16</span><span class="err">:</span><span class="mi">15</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">motd</span><span class="w">                                </span><span class="n">A</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">21</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="k">New</span><span class="w"> </span><span class="nc">Text</span><span class="w"> </span><span class="n">Document</span><span class="p">.</span><span class="n">txt</span><span class="w">               </span><span class="n">A</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Mon</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">22</span><span class="err">:</span><span class="mi">17</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">passwd</span><span class="w">                              </span><span class="n">A</span><span class="w">     </span><span class="mi">1055</span><span class="w">  </span><span class="n">Mon</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">25</span><span class="err">:</span><span class="mi">34</span><span class="w"> </span><span class="mi">2015</span>

<span class="w">            </span><span class="mi">40551</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="mf">262144.</span><span class="w"> </span><span class="mi">3397</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">available</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">fred</span><span class="p">.</span><span class="n">txt</span>
<span class="w">    </span><span class="n">putting</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">fred</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="err">\</span><span class="n">fred</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="p">(</span><span class="mf">14.6</span><span class="w"> </span><span class="n">kb</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">average</span><span class="w"> </span><span class="mf">14.6</span><span class="w"> </span><span class="n">kb</span><span class="o">/</span><span class="n">s</span><span class="p">)</span>
<span class="w">    </span><span class="nl">smb</span><span class="p">:</span><span class="w"> </span><span class="err">\</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dir</span>
<span class="w">      </span><span class="p">.</span><span class="w">                                  </span><span class="n">DR</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">58</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="p">..</span><span class="w">                                 </span><span class="n">DR</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">58</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">desktop</span><span class="p">.</span><span class="n">ini</span><span class="w">                       </span><span class="n">AHS</span><span class="w">       </span><span class="mi">46</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">16</span><span class="err">:</span><span class="mi">15</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">fred</span><span class="p">.</span><span class="n">txt</span><span class="w">                            </span><span class="n">A</span><span class="w">       </span><span class="mi">15</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">58</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">motd</span><span class="w">                                </span><span class="n">A</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Tue</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">21</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="k">New</span><span class="w"> </span><span class="nc">Text</span><span class="w"> </span><span class="n">Document</span><span class="p">.</span><span class="n">txt</span><span class="w">               </span><span class="n">A</span><span class="w">        </span><span class="mi">0</span><span class="w">  </span><span class="n">Mon</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">22</span><span class="err">:</span><span class="mi">17</span><span class="w"> </span><span class="mi">2015</span>
<span class="w">      </span><span class="n">passwd</span><span class="w">                              </span><span class="n">A</span><span class="w">     </span><span class="mi">1055</span><span class="w">  </span><span class="n">Mon</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">09</span><span class="err">:</span><span class="mi">25</span><span class="err">:</span><span class="mi">34</span><span class="w"> </span><span class="mi">2015</span>

<span class="w">            </span><span class="mi">40551</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">size</span><span class="w"> </span><span class="mf">262144.</span><span class="w"> </span><span class="mi">3397</span><span class="w"> </span><span class="n">blocks</span><span class="w"> </span><span class="n">available</span>
</code></pre></div></td></tr></table></div>

<p>Checking the result on "windows":</p>
<p><img alt="" src="../images/209-winshare.jpg" /></p>
<h3 id="example-allow-everyone-to-print-on-all-printers-on-sambaserver">Example: Allow everyone to print on all printers on "sambaserver"<a class="headerlink" href="#example-allow-everyone-to-print-on-all-printers-on-sambaserver" title="Permanent link">&para;</a></h3>
<p>The configuration section inserted or modified to implement this
example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">printers</span><span class="o">]</span>
<span class="w">      </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Printer</span><span class="w"> </span><span class="o">%</span><span class="n">p</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">%</span><span class="n">L</span>
<span class="w">      </span><span class="k">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">samba</span>
<span class="w">      </span><span class="n">printable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">browseable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>
<p>The special section <code>[printers]</code> is added.</p>
</li>
<li>
<p>Spool files are written to <code>/var/spool/samba</code>.</p>
</li>
<li>
<p>The services matching this section (all printers) are made
    printable.</p>
</li>
<li>
<p>The service is made browsable so it can be looked up by connecting
    to the server.</p>
</li>
<li>
<p>Guest access is enabled so no authentication is needed.</p>
</li>
</ul>
<p>Using Windows Explorer on Windows to browse and connnect to (enable)
printer_1. </p>
<p><img alt="" src="../images/209-connect-printer.jpg" /></p>
<p>Right click enables connecting to the printer and adding it
as a Generic text based printer. </p>
<p><img alt="" src="../images/209-devices.jpg" /></p>
<p>Right click Printer_1 and print test
page. Checking the spool file of the printer on "sambaserver":</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code>                                   Windows
                              Printer Test Page
    Congratulations!
    If you can read this information, you have correctly installed your 
    Generic / Text Only on WINDOWS.
    The information below describes your printer driver and port settings.
    Submitted Time: 11:45:31 AM .10/.26/.2015
    Computer name:  WINDOWS
    Printer name:   \\SAMBASERVER\Printer_1
    Printer model:  Generic / Text Only
    Color support:  No
    Port name(s):   \\SAMBASERVER\Printer_1
    Data format:    RAW
    Driver name:    UNIDRV.DLL
    Data file:      TTY.GPD
    Config file:    UNIDRVUI.DLL
    Help file:      UNIDRV.HLP
    Driver version: 6.00
    Environment:    Windows NT x86
    Additional files used by this driver:
     C:\Windows\system32\spool\DRIVERS\W32X86\3\TTYRES.DLL 
    (6.1.7600.16385 (win7_rtm.090713-1255))
     C:\Windows\system32\spool\DRIVERS\W32X86\3\TTY.INI
     C:\Windows\system32\spool\DRIVERS\W32X86\3\TTY.DLL 
    (6.1.7600.16385 (win7_rtm.090713-1255))
     C:\Windows\system32\spool\DRIVERS\W32X86\3\TTYUI.DLL 
    (6.1.7600.16385 (win7_rtm.090713-1255))
     C:\Windows\system32\spool\DRIVERS\W32X86\3\TTYUI.HLP
     C:\Windows\system32\spool\DRIVERS\W32X86\3\UNIRES.DLL 
    (6.1.7600.16385 (win7_rtm.090713-1255))
     C:\Windows\system32\spool\DRIVERS\W32X86\3\STDNAMES.GPD
     C:\Windows\system32\spool\DRIVERS\W32X86\3\STDDTYPE.GDL
     C:\Windows\system32\spool\DRIVERS\W32X86\3\STDSCHEM.GDL
     C:\Windows\system32\spool\DRIVERS\W32X86\3\STDSCHMX.GDL
    This is the end of the printer test page.
</code></pre></div></td></tr></table></div>

<h3 id="example-disallow-printing-on-printer_1-from-sambaclient">Example: Disallow printing on "Printer_1" from "sambaclient"<a class="headerlink" href="#example-disallow-printing-on-printer_1-from-sambaclient" title="Permanent link">&para;</a></h3>
<p>The configuration section inserted or modified to implement this
example:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">Printer_1</span><span class="o">]</span>
<span class="w">      </span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Printer</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">%</span><span class="n">L</span>
<span class="w">      </span><span class="k">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">samba</span>
<span class="w">      </span><span class="n">printer</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Printer_1</span>
<span class="w">      </span><span class="n">printable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">browseable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
<span class="w">      </span><span class="n">hosts</span><span class="w"> </span><span class="k">deny</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sambaclient</span>
</code></pre></div></td></tr></table></div>

<ul>
<li>
<p>A section is created to explicitely match "Printer_1"</p>
</li>
<li>
<p>Making the service printable identifies the service as a printer</p>
</li>
<li>
<p>Spool files are written to <code>/var/spool/samba</code></p>
</li>
<li>
<p>Print jobs are sent to the local printer queue "Printer_1"</p>
</li>
<li>
<p>The service is not made browseable, so cannot be looked up by
    connecting to the server</p>
</li>
<li>
<p>Guest access is enabled so no authentication is needed.</p>
</li>
<li>
<p>Access is explicitely denied for "sambaclient".</p>
</li>
</ul>
<p>Samba will first match the requested service against sections
explicitely matching the service name before trying a match on the
special section <code>[printers]</code>. Any service other than "Printer_1" will
not match any explicite sections and will fall through to the special
section <code>[printers]</code>. A request for service "Printer_1" will first
match the <code>[Printer_1]</code> section and will therefor never match the
special section <code>[printers]</code>.</p>
<p>Please note that in Samba it is not possible to configure something like
"sambaclient has access to all printer except for Printer_1". In this
case we need to configure all printers to accessible for all and add a
configuration for any exception.</p>
<p>Using <code>smbclient</code> to test printing from sambaclient</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="n">sambaserver</span><span class="o">/</span><span class="n">Printer_1</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="ss">&quot;print /etc/hosts&quot;</span><span class="w"> </span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">alice</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="nl">password</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>
<span class="w">    </span><span class="n">tree</span><span class="w"> </span><span class="k">connect</span><span class="w"> </span><span class="nl">failed</span><span class="p">:</span><span class="w"> </span><span class="n">NT_STATUS_ACCESS_DENIED</span>
</code></pre></div></td></tr></table></div>

<h3 id="example-list-available-services-on-sambaserver">Example: List available services on "sambaserver"<a class="headerlink" href="#example-list-available-services-on-sambaserver" title="Permanent link">&para;</a></h3>
<p>This example doesn't need additional configuration.</p>
<p>Using <code>smbclient</code> to create a listing of "sambaserver". Note the
comments.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="o">//</span><span class="n">SAMBASERVER</span>
<span class="w">    </span><span class="n">Enter</span><span class="w"> </span><span class="n">fred</span><span class="s1">&#39;s password: </span>
<span class="s1">    Domain=[OURGROUP] OS=[Unix] Server=[Samba 4.1.12]</span>

<span class="s1">        Sharename       Type      Comment</span>
<span class="s1">        ---------       ----      -------</span>
<span class="s1">        public          Disk      Public Storage on sambaserver</span>
<span class="s1">        share1          Disk      Share1 on sambaserver</span>
<span class="s1">        share2          Disk      share2 on sambaserver</span>
<span class="s1">        Printer_1       Printer   Printer 1 on sambaserver</span>
<span class="s1">        IPC$            IPC       IPC Service (Linux Samba Server sambaserver for LPIC2 examples)</span>
<span class="s1">        fred            Disk      fred&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">homedirectory</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">sambaserver</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">sambaclient</span>
<span class="w">        </span><span class="n">Printer_2</span><span class="w">       </span><span class="n">Printer</span><span class="w">   </span><span class="n">Cups</span><span class="w"> </span><span class="n">printer</span><span class="w"> </span><span class="n">Printer_2</span>
<span class="w">    </span><span class="k">Domain</span><span class="o">=[</span><span class="n">OURGROUP</span><span class="o">]</span><span class="w"> </span><span class="n">OS</span><span class="o">=[</span><span class="n">Unix</span><span class="o">]</span><span class="w"> </span><span class="n">Server</span><span class="o">=[</span><span class="n">Samba 4.1.12</span><span class="o">]</span>

<span class="w">        </span><span class="n">Server</span><span class="w">               </span><span class="n">Comment</span>
<span class="w">        </span><span class="c1">---------            -------</span>
<span class="w">        </span><span class="n">SAMBACLIENT</span><span class="w">          </span><span class="n">Samba</span><span class="w"> </span><span class="mf">4.1.12</span>
<span class="w">        </span><span class="n">SAMBASERVER</span><span class="w">          </span><span class="n">Linux</span><span class="w"> </span><span class="n">Samba</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">sambaserver</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">LPIC2</span><span class="w"> </span><span class="n">examples</span>
<span class="w">        </span><span class="n">SS2</span><span class="w">                  </span><span class="n">Linux</span><span class="w"> </span><span class="n">Samba</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">sambaserver</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">LPIC2</span><span class="w"> </span><span class="n">examples</span>

<span class="w">        </span><span class="n">Workgroup</span><span class="w">            </span><span class="n">Master</span>
<span class="w">        </span><span class="c1">---------            -------</span>
<span class="w">        </span><span class="n">OURGROUP</span><span class="w">             </span><span class="n">SAMBASERVER</span>
</code></pre></div></td></tr></table></div>

<h2 id="setting-up-a-nmbd-wins-server">Setting up a <code>nmbd</code> WINS server<a class="headerlink" href="#setting-up-a-nmbd-wins-server" title="Permanent link">&para;</a></h2>
<h3 id="what-is-a-wins-server">What is a WINS Server?<a class="headerlink" href="#what-is-a-wins-server" title="Permanent link">&para;</a></h3>
<p>WINS stands for Windows Internet Name Service. This is a name service
WINS used to translate NetBIOS names to ip addresses by using NetBIOS
over TCP/IP queries. This is done using UDP packets.</p>
<h3 id="using-samba-as-a-wins-server">Using Samba as a WINS Server<a class="headerlink" href="#using-samba-as-a-wins-server" title="Permanent link">&para;</a></h3>
<p>To tell Samba that it should also play the role of WINS Server, add
sambaWINS the following line to the <code>[global]</code> section of the Samba
configuration file <code>/etc/samba/smb.conf</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">global</span><span class="o">]</span>
<span class="w">    </span><span class="n">wins</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
</code></pre></div></td></tr></table></div>

<p>Be careful, there should not be more than one WINS Server on a network
and you should not set any of the other WINS parameters, such as "wins
server", when enabling "wins support".</p>
<p>Restart the smb and nmb services to pick up the changed configuration</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    # service smb restart
    # service nmb restart
</code></pre></div></td></tr></table></div>

<h4 id="creating-logon-scripts-for-clients">Creating logon scripts for clients<a class="headerlink" href="#creating-logon-scripts-for-clients" title="Permanent link">&para;</a></h4>
<p>Logon scripts can be very handy. For example, if every user needs
sambalogon scripts his home directory mapped to drive H: automatically,
a logon script can take care of that. The user is then presented with an
extra hard-drive which gives you, as an administrator, the freedom to
move home directories to another server should the need arise. To the
user it remains drive H:, and all you have to do is change one line in
the logon script.</p>
<p>The same goes for printers and processes that should be accessible or
run when a specific user logs on or when a certain machine logs on.</p>
<p>The batch file must be a Windows-style batch file and should thus have
both a carriage return and a line feed at the end of each line.</p>
<p>The first thing to do is enable logon support. This is done by adding
the following line to the <code>[global]</code> section of the Samba configuration
file <code>/etc/samba/smb.conf</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">global</span><span class="o">]</span>
<span class="w">    </span><span class="n">logon</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yes</span>
</code></pre></div></td></tr></table></div>

<p>The second thing to do is create a share called <code>[netlogon]</code> where the
logon scripts will reside and which is readable to all users:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">netlogon</span><span class="o">]</span>
<span class="w">      </span><span class="n">Comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Netlogon</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">clients</span>
<span class="w">      </span><span class="k">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">netlogon</span>
<span class="w">      </span><span class="n">browseable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="n">guest</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
<span class="w">      </span><span class="n">writeable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">no</span>
</code></pre></div></td></tr></table></div>

<p>The definition of the logon script depends on whether you want a script
per user or per client.</p>
<h4 id="based-on-the-users-name">Based on the user's name<a class="headerlink" href="#based-on-the-users-name" title="Permanent link">&para;</a></h4>
<p>Add the following line to the <code>[netlogon]</code> section:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    logon script = %U.bat
</code></pre></div></td></tr></table></div>

<p>and, assuming the user is "fred", create a file called
<code>/home/netlogon/fred.bat</code>.</p>
<h4 id="based-on-the-clients-name">Based on the client's name<a class="headerlink" href="#based-on-the-clients-name" title="Permanent link">&para;</a></h4>
<p>Add the following line to the <code>[netlogon]</code> section:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    logon script = %m.bat
</code></pre></div></td></tr></table></div>

<p>and, assuming the machine is called "workstation1", create a file called
<code>/home/netlogon/workstation1.bat</code>.</p>
<p>Configuring Samba as a domain member</p>
<p>To configure Samba4 as a domain member you need to make sure there is no
configuration present on the system before starting.</p>
<p>There are two options for joining a domain. The server can be a member
of and Active Directory domain or an older NT4 domain. Because an Active
Directory domain uses Kerberos and DNS it is importatnt to configure the
server correctly before joining the domain.</p>
<h3 id="configuring-dns">Configuring DNS<a class="headerlink" href="#configuring-dns" title="Permanent link">&para;</a></h3>
<p>For the server to locate the domain it is important that the DNS
settings are configured correctly. An AD DC has a built-in DNS server
which should be used by the system we want to connect. When manually
configuring the ip settings you should configure the AD Domain
Controller as the DNS server. How you do this depends on the
distribution you use.</p>
<p>When configured correctly your<code>/etc/resolv.conf</code> file should look as
follows when the AD Domain Controller has an ipaddres of 192.168.1.2 and
the domain is example.com:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    nameserver 192.168.1.2
    search example.com
</code></pre></div></td></tr></table></div>

<p>When you join the host to the domain Samba tries to register the host in
the AD DNS zone. For this the <code>net</code> utility tries to resolve the
hostname using DNS or a correct entry in /etc/hosts.</p>
<p>When using <code>/etc/hosts</code> it is important that the hostname or FQDN
doesn't resolve to 127.0.0.1. Because of this, a correctly configured
hostfile will look as follows where server2.example.com is the hostname
of the server we are adding as a domain member:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    127.0.0.1   localhost localhost.localdomain
    192.168.1.3 server2.example.com server2
</code></pre></div></td></tr></table></div>

<p>To check if the resolution is correct you can use the <code>getent</code> command
as follows:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    $ getent hosts server2
    192.168.1.3 server2.example.com server2
</code></pre></div></td></tr></table></div>

<h3 id="configuring-kerberos">Configuring Kerberos<a class="headerlink" href="#configuring-kerberos" title="Permanent link">&para;</a></h3>
<p>Currently Samba uses Heimdal Kerberos. This means that the Kerberos file
<code>/etc/krb5.conf</code> only needs to contain the following information:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">libdefaults</span><span class="o">]</span>
<span class="w">        </span><span class="n">default_realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EXAMPLE</span><span class="p">.</span><span class="n">COM</span>
<span class="w">        </span><span class="n">dns_lookup_realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span>
<span class="w">        </span><span class="n">dns_lookup_kdc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
</code></pre></div></td></tr></table></div>

<p>Using anyting other than the above can lead to errors.</p>
<p>You will need to replace EXAMPLE.COM with you Kerberos realm.</p>
<p>Kerberos requires a synchronised time on all domain members. It is
recommended to set up a NTP client.</p>
<h3 id="configuring-samba">Configuring Samba<a class="headerlink" href="#configuring-samba" title="Permanent link">&para;</a></h3>
<p>The previous steps are only necessary when joining an Active Directory
domain. The following steps are needed for both an Active Directory
domain and a NT4 domain.</p>
<h4 id="setting-up-the-smbconf-file">Setting up the smb.conf file<a class="headerlink" href="#setting-up-the-smbconf-file" title="Permanent link">&para;</a></h4>
<p>The next step is to configure the domain members <code>smb.conf</code> file. This
file is usually located at <code>/etc/smb/smb.conf</code> or <code>/etc/samba/smb.conf</code>.
If not you can use the following command to locate the file:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    $ smbd -b | grep CONFIGFILE
    CONFIGFILE: /usr/local/samba/etc/smb.conf
</code></pre></div></td></tr></table></div>

<p>Now that we know where the file is located we can add the following
configuration:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="o">[</span><span class="n">global</span><span class="o">]</span>
<span class="w">        </span><span class="n">security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ADS</span>
<span class="w">        </span><span class="n">workgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EXAMPLE</span>
<span class="w">        </span><span class="n">realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EXAMPLE</span><span class="p">.</span><span class="n">COM</span>

<span class="w">        </span><span class="nf">log</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="nf">var</span><span class="o">/</span><span class="nf">log</span><span class="o">/</span><span class="n">samba</span><span class="o">/%</span><span class="n">m</span><span class="p">.</span><span class="nf">log</span>
<span class="w">        </span><span class="nf">log</span><span class="w"> </span><span class="k">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Default</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">local</span><span class="w"> </span><span class="n">BUILTIN</span><span class="w"> </span><span class="n">accounts</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">domain</span><span class="w"> </span><span class="k">member</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">domain</span><span class="err">:</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="k">domain</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="n">configuration</span><span class="err">!</span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">read</span><span class="o">-</span><span class="k">write</span><span class="o">-</span><span class="n">enabled</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">tdb</span><span class="p">.</span>
<span class="w">        </span><span class="n">idmap</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tdb</span>
<span class="w">        </span><span class="n">idmap</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3000</span><span class="o">-</span><span class="mi">7999</span>
</code></pre></div></td></tr></table></div>

<h4 id="joining-the-domain">Joining the domain<a class="headerlink" href="#joining-the-domain" title="Permanent link">&para;</a></h4>
<p>Now that we have configured samba it's time to join the domain. As also
stated above it's not supported to use the <code>samba-tool</code> utility to do
this.</p>
<p>To join a domain you can use the following command. The output will
depend on the type of domain you're joining.</p>
<p>When joining an Active Directory domain:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>    $ net ads join U administrator
    Enter administrators password:
    Using short domain name  EXAMPLE
    Joined server2 to dns domain example.com
</code></pre></div></td></tr></table></div>

<p>When joining a NT4 domain:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>    $ net ads join U administrator
    Enter administrators password:
    Joined domain EXAMPLE.
</code></pre></div></td></tr></table></div>

<h4 id="configuring-the-name-service-switch-nss">Configuring the Name Service Switch (NSS)<a class="headerlink" href="#configuring-the-name-service-switch-nss" title="Permanent link">&para;</a></h4>
<p>To make the domain users and groups available to the local system we
have to append the winbind entry to the following databases in
<code>/etc/nsswitch.conf</code>:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>    passwd: files winbind
    group: files winbind
</code></pre></div></td></tr></table></div>

<h4 id="starting-the-services">Starting the services<a class="headerlink" href="#starting-the-services" title="Permanent link">&para;</a></h4>
<p>Now we can start the services. If you only need Samba to lookup domain
users and groups you only have to start the <code>winbind</code> service. If you
also set up file and printer sharing you also need to start the <code>smbd</code>
and <code>nmbd</code> services.</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>    $ systemctl start winbind smbd nmbd
</code></pre></div></td></tr></table></div>

<p>You should NOT start the <code>samba</code> service. This service is only required
on Active Directory Domain Controllers,</p>
<h4 id="testing-the-winbind-connectivity">Testing the winbind connectivity<a class="headerlink" href="#testing-the-winbind-connectivity" title="Permanent link">&para;</a></h4>
<p>To verify if the winbind service is able to connect to Active Directory
Domain Controllers or NT4 Domain Controllers you can use the <code>wbinfo</code>
command:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="err">$</span><span class="w"> </span><span class="n">wbinfo</span><span class="w"> </span><span class="c1">--ping-dc</span>
<span class="w">    </span><span class="n">Checking</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NETLOGON</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">domain</span><span class="o">[</span><span class="n">EXAMPLE</span><span class="o">]</span><span class="w"> </span><span class="n">dc</span><span class="w"> </span><span class="k">connection</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="ss">&quot;server1.example.com&quot;</span><span class="w"> </span><span class="n">succeeded</span>
</code></pre></div></td></tr></table></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 1997-2021 Sue B.V., The Netherlands - Open Sourced 2021
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["search.highlight", "tabs", "instant"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>